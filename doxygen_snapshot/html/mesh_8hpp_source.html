<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ALPSCore reference: alps/gf/mesh.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://www.mathjax.org/mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ALPSCore reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5f14571c84830c859f12c222c71eff5c.html">alps</a></li><li class="navelem"><a class="el" href="dir_83c5ad52cce83741b8db13d0e54bc4cd.html">gf</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mesh.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mesh_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (C) 1998-2018 ALPS Collaboration. See COPYRIGHT.TXT</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * All rights reserved. Use is subject to license terms. See LICENSE.TXT</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * For use in publications, see ACKNOWLEDGE.TXT</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;complex&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;type_traits&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;boost/multi_array.hpp&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;boost/operators.hpp&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="archive_8hpp.html">alps/hdf5/archive.hpp</a>&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="complex_8hpp.html">alps/hdf5/complex.hpp</a>&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="vector_8hpp.html">alps/hdf5/vector.hpp</a>&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="multi__array_8hpp.html">alps/hdf5/multi_array.hpp</a>&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#ifdef ALPS_HAVE_MPI</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mpi__bcast_8hpp.html">mpi_bcast.hpp</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="flagcheck_8hpp.html">flagcheck.hpp</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="piecewise__polynomial_8hpp.html">piecewise_polynomial.hpp</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacealps.html">alps</a> {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">namespace </span>gf {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf_1_1statistics.html">   30</a></span>&#160;        <span class="keyword">namespace </span>statistics {</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">   31</a></span>&#160;            <span class="keyword">enum</span> <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics_type</a> {</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992a5186b8900b5e2ef2a9316840d7463c6f">   32</a></span>&#160;                <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992a5186b8900b5e2ef2a9316840d7463c6f">BOSONIC</a>=0,</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">   33</a></span>&#160;                <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">FERMIONIC</a>=1</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            };</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        }</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> X&gt;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1generic__index.html">   39</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index</a> :</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            boost::additive2&lt;generic_index&lt;X&gt;, int,</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            boost::unit_steppable&lt; generic_index&lt;X&gt;,</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            boost::totally_ordered2&lt; generic_index&lt;X&gt;, int&gt; &gt; &gt;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            <span class="keyword">private</span>:</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <span class="keywordtype">int</span> index_;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keyword">public</span>:</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1generic__index.html#adcfad35c459ef2dede788f72f22567c1">   47</a></span>&#160;            <span class="keyword">explicit</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html#adcfad35c459ef2dede788f72f22567c1">generic_index</a>(<span class="keywordtype">int</span> i): index_(i) {}</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1generic__index.html#a8bf01ca78562b9d4f73159291acdd499">   48</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1generic__index.html#a8bf01ca78562b9d4f73159291acdd499">generic_index</a>() : index_(0) {}</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1generic__index.html#a587673ab9633d138c5c97848b262e3b5">   50</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html#a587673ab9633d138c5c97848b262e3b5">operator=</a>(<span class="keywordtype">int</span> i) { index_=i; }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1generic__index.html#a0b0ffe664b28730cc00c1963ca092764">   52</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index</a>&amp; <a class="code" href="classalps_1_1gf_1_1generic__index.html#a0b0ffe664b28730cc00c1963ca092764">operator++</a>() { index_++; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1generic__index.html#a08c2e12bf7dfb0b7383f5f64acd3bafd">   53</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index</a>&amp; <a class="code" href="classalps_1_1gf_1_1generic__index.html#a08c2e12bf7dfb0b7383f5f64acd3bafd">operator--</a>() { index_--; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1generic__index.html#a064b8ff1064ae1bacf81fad1e9bf9344">   55</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index</a>&amp; <a class="code" href="classalps_1_1gf_1_1generic__index.html#a064b8ff1064ae1bacf81fad1e9bf9344">operator+=</a>(<span class="keywordtype">int</span> i) { index_+=i; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1generic__index.html#a6986dd5e127aea75e5474982de205488">   56</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index</a>&amp; <a class="code" href="classalps_1_1gf_1_1generic__index.html#a6986dd5e127aea75e5474982de205488">operator-=</a>(<span class="keywordtype">int</span> i) { index_-=i; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1generic__index.html#a96ab537cce7d3654b03912227131c876">   58</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html#a96ab537cce7d3654b03912227131c876">operator&lt;</a>(<span class="keywordtype">int</span> x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> index_ &lt;x; }</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1generic__index.html#a411caf4e4f4cba02dcd1ef09778e37fb">   59</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html#a411caf4e4f4cba02dcd1ef09778e37fb">operator&gt;</a>(<span class="keywordtype">int</span> x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> index_ &gt;x; }</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1generic__index.html#ae14f6cca58715cba7fdc4a5588930d30">   60</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html#ae14f6cca58715cba7fdc4a5588930d30">operator==</a>(<span class="keywordtype">int</span> x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> index_==x; }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1generic__index.html#a60ecc2ec965268ac4437d00ed6184373">   62</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html#a60ecc2ec965268ac4437d00ed6184373">operator()</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> index_; }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#ifdef ALPS_HAVE_MPI</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;          <span class="keywordtype">void</span> <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a>&amp; comm, <span class="keywordtype">int</span> root) {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                <a class="code" href="namespacealps_1_1mpi.html#a4b3ef8026e4d4dd8ce8c0c6f05c1347f">alps::mpi::broadcast</a>(comm, index_, root);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        };</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf_1_1mesh.html">   70</a></span>&#160;        <span class="keyword">namespace </span>mesh {</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33d">   71</a></span>&#160;            <span class="keyword">enum</span> <a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33d">frequency_positivity_type</a> {</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33da88b934123cf42710c685e88ac52b649c">   72</a></span>&#160;                <a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33da88b934123cf42710c685e88ac52b649c">POSITIVE_NEGATIVE</a>=0,</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33da62e5bad0c8e46cfbf0795fbd5cee952b">   73</a></span>&#160;                <a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33da62e5bad0c8e46cfbf0795fbd5cee952b">POSITIVE_ONLY</a>=1</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            };</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        }</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1base__mesh.html">   77</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classalps_1_1gf_1_1base__mesh.html">base_mesh</a> {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keyword">public</span>:</div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1base__mesh.html#ae9897cad2f596791e4eed2245d4adad3">   79</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1base__mesh.html#ae9897cad2f596791e4eed2245d4adad3">base_mesh</a>() {}</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1base__mesh.html#a4a155d1871ab1b1d201a53785bc9a271">   80</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1base__mesh.html#a4a155d1871ab1b1d201a53785bc9a271">base_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1base__mesh.html">base_mesh</a>&amp; rhs) : points_(rhs.points_) {}</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1base__mesh.html#a9be1891f8c0bc567695fad180712313a">   82</a></span>&#160;            <span class="keyword">const</span> std::vector&lt;double&gt; &amp;<a class="code" href="classalps_1_1gf_1_1base__mesh.html#a9be1891f8c0bc567695fad180712313a">points</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> points_;}</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keyword">protected</span>:</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="comment">// we do not want external functions be able to change a grid.</span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1base__mesh.html#aca05e67b85d0c631f568d746da26f056">   85</a></span>&#160;            std::vector&lt;double&gt; &amp;<a class="code" href="classalps_1_1gf_1_1base__mesh.html#aca05e67b85d0c631f568d746da26f056">_points</a>() {<span class="keywordflow">return</span> points_;}</div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1base__mesh.html#aa568cbdc80f04312e070eaa12187691a">   86</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1base__mesh.html#aa568cbdc80f04312e070eaa12187691a">swap</a>(<a class="code" href="classalps_1_1gf_1_1base__mesh.html">base_mesh</a> &amp;other) {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <span class="keyword">using</span> <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">std::swap</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">swap</a>(this-&gt;points_, other.points_);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keyword">private</span>:</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            std::vector&lt;double&gt; points_;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        };</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html">   95</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html">real_frequency_mesh</a>: <span class="keyword">public</span> <a class="code" href="classalps_1_1gf_1_1base__mesh.html">base_mesh</a>{</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="keyword">inline</span> <span class="keywordtype">void</span> throw_if_empty()<span class="keyword"> const </span>{</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                <span class="keywordflow">if</span> (extent() == 0) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;real_frequency_mesh is empty&quot;</span>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keyword">public</span>:</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html#a6da32a1fb6b23f09a8567e4224cc9ce3">  102</a></span>&#160;            <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index&lt;real_frequency_mesh&gt;</a> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a6da32a1fb6b23f09a8567e4224cc9ce3">index_type</a>;</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html#a6acaba26df449fc59c52a744ceb6ef8e">  103</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a6acaba26df449fc59c52a744ceb6ef8e">real_frequency_mesh</a>() {};</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html#a447a9aec86a00db7b1e69cfb8f33d1a3">  104</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a447a9aec86a00db7b1e69cfb8f33d1a3">real_frequency_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html">real_frequency_mesh</a>&amp; rhs) : <a class="code" href="classalps_1_1gf_1_1base__mesh.html">base_mesh</a>(rhs) {}</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="keyword">template</span>&lt;<span class="keyword">typename</span> GRID&gt;</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html#a606cc617dc48fdc7e7f9ee12de741933">  107</a></span>&#160;            <span class="keyword">explicit</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a606cc617dc48fdc7e7f9ee12de741933">real_frequency_mesh</a>(<span class="keyword">const</span> GRID &amp; grid)  {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                grid.compute_points(_points());</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            }</div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html#a88e29b2a3989d7a39c0acb1db87ae588">  110</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a88e29b2a3989d7a39c0acb1db87ae588">extent</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> points().size();}</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html#a3a66807ade5895d91d1672dd0a93c361">  112</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a3a66807ade5895d91d1672dd0a93c361">operator()</a>(index_type idx)<span class="keyword"> const </span>{</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;              throw_if_empty();</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;              <span class="keywordflow">return</span> idx();</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            }</div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html#ace14cfc8456b08cf0aa115cd23bc356c">  118</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#ace14cfc8456b08cf0aa115cd23bc356c">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)<span class="keyword"> const</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &lt;&lt; <span class="stringliteral">&quot;REAL_FREQUENCY&quot;</span>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                ar[path+<span class="stringliteral">&quot;/points&quot;</span>] &lt;&lt; points();</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html#a13f9fb50dfa35b474bfa8e65f373ebdd">  125</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a13f9fb50dfa35b474bfa8e65f373ebdd">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                std::string kind;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>]   &gt;&gt; kind;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="keywordflow">if</span> (kind!=<span class="stringliteral">&quot;REAL_FREQUENCY&quot;</span>) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempt to read real frequency mesh from non-real frequency data, kind=&quot;</span>+kind);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                ar[path+<span class="stringliteral">&quot;/points&quot;</span>] &gt;&gt; _points();</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html#a1029f813d107be9f18a8cb5d6a42a5f2">  134</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a1029f813d107be9f18a8cb5d6a42a5f2">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)<span class="keyword"> const</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#af7bd6d9b36671271f03c94f7cd0bd324">save</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html#a78ec34a6662260d91a439d56c5242239">  140</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a78ec34a6662260d91a439d56c5242239">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#ad7d3b93546b617b7dd2c737f41778de0">load</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html#a3b5999ed6f4bc7b79a8330a193200569">  146</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a3b5999ed6f4bc7b79a8330a193200569">operator==</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html">real_frequency_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <span class="keywordflow">return</span> extent()==mesh.<a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a88e29b2a3989d7a39c0acb1db87ae588">extent</a>() &amp;&amp; std::equal ( mesh.<a class="code" href="classalps_1_1gf_1_1base__mesh.html#a9be1891f8c0bc567695fad180712313a">points</a>().begin(), mesh.<a class="code" href="classalps_1_1gf_1_1base__mesh.html#a9be1891f8c0bc567695fad180712313a">points</a>().end(), points().begin() );;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__frequency__mesh.html#a8fb6812c5bf81d205576fdc2d4807b56">  152</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a8fb6812c5bf81d205576fdc2d4807b56">operator!=</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html">real_frequency_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="keywordflow">return</span> !(*<span class="keyword">this</span>==mesh);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#ifdef ALPS_HAVE_MPI</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordtype">void</span> <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a>&amp; comm, <span class="keywordtype">int</span> root)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keyword">using</span> <a class="code" href="namespacealps_1_1mpi.html#a4b3ef8026e4d4dd8ce8c0c6f05c1347f">alps::mpi::broadcast</a>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="keywordflow">if</span>(comm.<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>() == root) throw_if_empty();</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="namespacealps.html#ad18068978b72b94a2ba76995d8afc022">size</a> = extent();</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, size, root);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <span class="keywordflow">if</span>(root!=comm.<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>()) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    _points().resize(size);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, _points().data(), extent(), root);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        };</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        std::ostream &amp;<a class="code" href="namespacealps_1_1gf.html#a0c072dc142db347cd3713f168f0789d8">operator&lt;&lt;</a>(std::ostream &amp;os, <span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html">real_frequency_mesh</a> &amp;M);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keyword">template</span> &lt;mesh::frequency_positivity_type PTYPE&gt;</div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html">  175</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html">matsubara_mesh</a> : <span class="keyword">public</span> <a class="code" href="classalps_1_1gf_1_1base__mesh.html">base_mesh</a> {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordtype">double</span> beta_;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keywordtype">int</span> nfreq_;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a> statistics_;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33d">mesh::frequency_positivity_type</a> positivity_=PTYPE;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="comment">//FIXME: we had this const, but that prevents copying.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordtype">int</span> offset_;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keyword">inline</span> <span class="keywordtype">void</span> throw_if_empty()<span class="keyword"> const </span>{</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <span class="keywordflow">if</span> (extent() == 0) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;matsubara_mesh is empty&quot;</span>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keyword">public</span>:</div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#aa25b38b83f363fd299253dd34f3bdf5f">  192</a></span>&#160;            <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index&lt;matsubara_mesh&gt;</a> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#aa25b38b83f363fd299253dd34f3bdf5f">index_type</a>;</div><div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#a20f6d4710a4b21835a636eb0eaf1774c">  194</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#a20f6d4710a4b21835a636eb0eaf1774c">matsubara_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html">matsubara_mesh</a>&amp; rhs) : beta_(rhs.beta_), nfreq_(rhs.nfreq_), statistics_(rhs.statistics_), offset_(rhs.offset_) {check_range();compute_points();}</div><div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#a841f5cd66bcd3e6ebdf6ccb18efa39fd">  195</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#a841f5cd66bcd3e6ebdf6ccb18efa39fd">matsubara_mesh</a>():</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                beta_(0.0), nfreq_(0), statistics_(statistics::<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">FERMIONIC</a>), offset_(-1)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#a659ce1a93ca0dd2463ab15df3771cd91">  200</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#a659ce1a93ca0dd2463ab15df3771cd91">matsubara_mesh</a>(<span class="keywordtype">double</span> b, <span class="keywordtype">int</span> nfr, <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">gf::statistics::statistics_type</a> statistics=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">statistics::FERMIONIC</a>):</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                beta_(b), nfreq_(nfr), statistics_(statistics), offset_((PTYPE==mesh::<a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33da62e5bad0c8e46cfbf0795fbd5cee952b">POSITIVE_ONLY</a>)?0:nfr/2) {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                check_range();</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                compute_points();</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            }</div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#ad200b2c8fe030847488b985742e7de87">  205</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#ad200b2c8fe030847488b985742e7de87">extent</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> nfreq_;}</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#aa2de6a4ca4d0688cd18dd930bbced6c7">  208</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#aa2de6a4ca4d0688cd18dd930bbced6c7">operator()</a>(index_type idx)<span class="keyword"> const </span>{</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="keywordflow">return</span> offset_+idx(); <span class="comment">// FIXME: can be improved by specialization?</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#abb9d259df5acea876ca12acf13923158">  216</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#abb9d259df5acea876ca12acf13923158">operator==</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html">matsubara_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <span class="keywordflow">return</span> beta_==mesh.beta_ &amp;&amp; nfreq_==mesh.nfreq_ &amp;&amp; statistics_==mesh.statistics_ &amp;&amp; offset_ == mesh.offset_;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#a51d806b61f907e329a6f9a41abb9077e">  222</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#a51d806b61f907e329a6f9a41abb9077e">operator!=</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html">matsubara_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <span class="keywordflow">return</span> !(*<span class="keyword">this</span>==mesh);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#aa8c7ea4ee38b6ebff477fae0c6aec8f7">  228</a></span>&#160;            <span class="keywordtype">double</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#aa8c7ea4ee38b6ebff477fae0c6aec8f7">beta</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> beta_;}</div><div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#a33845e38598a9f359196b3c5d8a84bd8">  229</a></span>&#160;            <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#a33845e38598a9f359196b3c5d8a84bd8">statistics</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> statistics_;}</div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#a358481821a7ad7f128dfad26bea6852a">  230</a></span>&#160;            <a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33d">mesh::frequency_positivity_type</a> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#a358481821a7ad7f128dfad26bea6852a">positivity</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> positivity_;}</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="comment">// It&#39;s a member function to avoid dealing with templated friend decalration.</span></div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#a60cad24496cfff82dcd92e7368ec1adb">  234</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#a60cad24496cfff82dcd92e7368ec1adb">swap</a>(<a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html">matsubara_mesh</a>&amp; other) {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="keywordflow">if</span>(statistics_!=other.statistics_)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempt to swap two meshes with different statistics.&quot;</span>);<span class="comment">// FIXME: specific exception</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keyword">using</span> <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">std::swap</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">swap</a>(this-&gt;beta_, other.beta_);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">swap</a>(this-&gt;nfreq_, other.nfreq_);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <a class="code" href="classalps_1_1gf_1_1base__mesh.html#aa568cbdc80f04312e070eaa12187691a">base_mesh::swap</a>(other);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#a6f037beb9e347fcbc529eb41345e0e75">  244</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#a6f037beb9e347fcbc529eb41345e0e75">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)<span class="keyword"> const</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &lt;&lt; <span class="stringliteral">&quot;MATSUBARA&quot;</span>;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                ar[path+<span class="stringliteral">&quot;/N&quot;</span>] &lt;&lt; nfreq_;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                ar[path+<span class="stringliteral">&quot;/statistics&quot;</span>] &lt;&lt; int(statistics_); <span class="comment">//</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                ar[path+<span class="stringliteral">&quot;/beta&quot;</span>] &lt;&lt; beta_;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                ar[path+<span class="stringliteral">&quot;/positive_only&quot;</span>] &lt;&lt; int(positivity_);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                ar[path+<span class="stringliteral">&quot;/points&quot;</span>] &lt;&lt; points();</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#aae8541a155e29c5007e7e0d179bf4d85">  255</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#aae8541a155e29c5007e7e0d179bf4d85">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                std::string kind;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &gt;&gt; kind;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <span class="keywordflow">if</span> (kind!=<span class="stringliteral">&quot;MATSUBARA&quot;</span>) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempt to read Matsubara mesh from non-Matsubara data, kind=&quot;</span>+kind); <span class="comment">// FIXME: specific exception</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <span class="keywordtype">double</span> nfr, beta;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keywordtype">int</span> stat, posonly;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                ar[path+<span class="stringliteral">&quot;/N&quot;</span>] &gt;&gt; nfr;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                ar[path+<span class="stringliteral">&quot;/statistics&quot;</span>] &gt;&gt; stat;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                ar[path+<span class="stringliteral">&quot;/beta&quot;</span>] &gt;&gt; beta;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                ar[path+<span class="stringliteral">&quot;/positive_only&quot;</span>] &gt;&gt; posonly;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                statistics_=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a>(stat);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33d">mesh::frequency_positivity_type</a>(posonly)!=positivity_) {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                    <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Attempt to read Matsubara mesh with the wrong positivity type &quot;</span>+std::to_string(posonly) ); <span class="comment">// FIXME: specific exception? Verbose positivity?</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                };</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                beta_=beta;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                nfreq_=nfr;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                offset_ = ((PTYPE==<a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33da62e5bad0c8e46cfbf0795fbd5cee952b">mesh::POSITIVE_ONLY</a>)?0:nfr/2);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                check_range();</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                compute_points();</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#a230cf0e279596505db0cb5f78b2bf208">  280</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#a230cf0e279596505db0cb5f78b2bf208">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)<span class="keyword"> const</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#af7bd6d9b36671271f03c94f7cd0bd324">save</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#a6179662d3e53f2556de27d6056c556ab">  286</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#a6179662d3e53f2556de27d6056c556ab">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#ad7d3b93546b617b7dd2c737f41778de0">load</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor">#ifdef ALPS_HAVE_MPI</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <span class="keywordtype">void</span> <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a>&amp; comm, <span class="keywordtype">int</span> root)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                <span class="keyword">using</span> <a class="code" href="namespacealps_1_1mpi.html#a4b3ef8026e4d4dd8ce8c0c6f05c1347f">alps::mpi::broadcast</a>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                <span class="keywordflow">if</span>(comm.<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>() == root) throw_if_empty();</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                <span class="comment">// FIXME: introduce (debug-only?) consistency check, like type checking? akin to load()?</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, beta_, root);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, nfreq_, root);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <span class="keywordtype">int</span> stat = int(statistics_);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, stat, root);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                statistics_ = <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a>(stat);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <span class="keywordtype">int</span> pos = int(positivity_);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, pos, root);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33d">mesh::frequency_positivity_type</a>(pos)!=positivity_) {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                  <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Attempt to broadcast Matsubara mesh with the wrong positivity type &quot;</span>+std::to_string(pos) ); <span class="comment">// FIXME: specific exception? Verbose positivity?</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                };</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                offset_ = ((PTYPE==<a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33da62e5bad0c8e46cfbf0795fbd5cee952b">mesh::POSITIVE_ONLY</a>)?0:nfreq_/2);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <span class="keywordflow">try</span> {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    check_range();</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; exc) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    <span class="keywordtype">int</span> wrank=<a class="code" href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a>().<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>();</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    <span class="comment">// FIXME? Try to communiucate the error with all ranks, at least in debug mode?</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    std::cerr &lt;&lt; <span class="stringliteral">&quot;matsubara_mesh&lt;&gt;::broadcast() exception at WORLD rank=&quot;</span> &lt;&lt; wrank &lt;&lt; std::endl</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                              &lt;&lt; exc.what()</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;\nAborting.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    MPI_Abort(MPI_COMM_WORLD,1);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                compute_points(); <span class="comment">// recompute points rather than sending them over MPI</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#acbea80c76ab6e22306ccce10eb4e5a91">  323</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#acbea80c76ab6e22306ccce10eb4e5a91">check_range</a>(){</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <span class="keywordflow">if</span>(statistics_!=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">statistics::FERMIONIC</a> &amp;&amp; statistics_!=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992a5186b8900b5e2ef2a9316840d7463c6f">statistics::BOSONIC</a>) <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;statistics should be bosonic or fermionic&quot;</span>);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keywordflow">if</span>(positivity_!=<a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33da62e5bad0c8e46cfbf0795fbd5cee952b">mesh::POSITIVE_ONLY</a> &amp;&amp;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                   positivity_!=<a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33da88b934123cf42710c685e88ac52b649c">mesh::POSITIVE_NEGATIVE</a>) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;positivity should be POSITIVE_ONLY or POSITIVE_NEGATIVE&quot;</span>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            }</div><div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1matsubara__mesh.html#a1c37e929a3af6f964cd93d82f7937056">  331</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#a1c37e929a3af6f964cd93d82f7937056">compute_points</a>(){</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                _points().resize(extent());</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nfreq_;++i){</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    _points()[i]=(2*(i-offset_)+statistics_)*M_PI/beta_;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        };</div><div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#a85c3936ffcff44fc3ee956587f812adb">  340</a></span>&#160;        <span class="keyword">template</span>&lt;mesh::frequency_positivity_type PTYPE&gt; std::ostream &amp;operator&lt;&lt;(std::ostream &amp;os, const matsubara_mesh&lt;PTYPE&gt; &amp;M){</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          os&lt;&lt;<span class="stringliteral">&quot;# &quot;</span>&lt;&lt;<span class="stringliteral">&quot;MATSUBARA&quot;</span>&lt;&lt;<span class="stringliteral">&quot; mesh: N: &quot;</span>&lt;&lt;M.<a class="code" href="classalps_1_1gf_1_1real__frequency__mesh.html#a88e29b2a3989d7a39c0acb1db87ae588">extent</a>()&lt;&lt;<span class="stringliteral">&quot; beta: &quot;</span>&lt;&lt;M.beta()&lt;&lt;<span class="stringliteral">&quot; statistics: &quot;</span>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          os&lt;&lt;(M.statistics()==<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">statistics::FERMIONIC</a>?<span class="stringliteral">&quot;FERMIONIC&quot;</span>:<span class="stringliteral">&quot;BOSONIC&quot;</span>)&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          os&lt;&lt;(M.positivity()==<a class="code" href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33da62e5bad0c8e46cfbf0795fbd5cee952b">mesh::POSITIVE_ONLY</a>?<span class="stringliteral">&quot;POSITIVE_ONLY&quot;</span>:<span class="stringliteral">&quot;POSITIVE_NEGATIVE&quot;</span>);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          os&lt;&lt;std::endl;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          <span class="keywordflow">return</span> os;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keyword">template</span> &lt;mesh::frequency_positivity_type PTYPE&gt;</div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">  350</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">swap</a>(<a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html">matsubara_mesh&lt;PTYPE&gt;</a>&amp; a, <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html">matsubara_mesh&lt;PTYPE&gt;</a>&amp; b) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            a.<a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html#a60cad24496cfff82dcd92e7368ec1adb">swap</a>(b);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html">  354</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classalps_1_1gf_1_1itime__mesh.html">itime_mesh</a> {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordtype">double</span> beta_;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordtype">int</span> ntau_;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keywordtype">bool</span> last_point_included_;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="keywordtype">bool</span> half_point_mesh_;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a> statistics_;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            std::vector&lt;double&gt; points_;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keyword">inline</span> <span class="keywordtype">void</span> throw_if_empty()<span class="keyword"> const </span>{</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="keywordflow">if</span> (extent() == 0) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;itime_mesh is empty&quot;</span>);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keyword">public</span>:</div><div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#a7a2bbcf7afb8669e6c0e3641464832cd">  369</a></span>&#160;            <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index&lt;itime_mesh&gt;</a> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#a7a2bbcf7afb8669e6c0e3641464832cd">index_type</a>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#aed03bcfb332f7f2e10c3ee76b264bca6">  371</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#aed03bcfb332f7f2e10c3ee76b264bca6">itime_mesh</a>(): beta_(0.0), ntau_(0), last_point_included_(true), half_point_mesh_(false), statistics_(statistics::<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">FERMIONIC</a>)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#a17d42b39f148e3ae14f4b691485b6cb0">  375</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#a17d42b39f148e3ae14f4b691485b6cb0">itime_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html">itime_mesh</a>&amp;rhs): beta_(rhs.beta_), ntau_(rhs.ntau_),</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                              last_point_included_(rhs.last_point_included_), half_point_mesh_(rhs.half_point_mesh_), statistics_(rhs.statistics_){</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;              compute_points();</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#a06117374f9d05c34079cb36cdfbf92e9">  381</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#a06117374f9d05c34079cb36cdfbf92e9">itime_mesh</a>(<span class="keywordtype">double</span> beta, <span class="keywordtype">int</span> ntau): beta_(beta), ntau_(ntau), last_point_included_(true), half_point_mesh_(false), statistics_(statistics::<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">FERMIONIC</a>){</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;              compute_points();</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            }</div><div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#ab7247de583fbf809d9088fa940ebab3c">  385</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#ab7247de583fbf809d9088fa940ebab3c">operator()</a>(index_type idx)<span class="keyword"> const </span>{</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="keywordflow">return</span> idx();</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            }</div><div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#a675bafdead97dbac5d9e0779f0a9d423">  391</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#a675bafdead97dbac5d9e0779f0a9d423">extent</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> ntau_;}</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#a40bf6de706b8e7d66126f767bab9ff6b">  394</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#a40bf6de706b8e7d66126f767bab9ff6b">operator==</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html">itime_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                <span class="keywordflow">return</span> beta_==mesh.beta_ &amp;&amp; ntau_==mesh.ntau_ &amp;&amp; last_point_included_==mesh.last_point_included_ &amp;&amp;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                    half_point_mesh_ == mesh.half_point_mesh_ &amp;&amp; statistics_==mesh.statistics_;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#a327357187cd7130d002dc7ea436b5025">  401</a></span>&#160;            <span class="keywordtype">double</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#a327357187cd7130d002dc7ea436b5025">beta</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> beta_;}</div><div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#acac73dc8ebdb4c0faa4b3e789e5a8ab0">  402</a></span>&#160;            <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#acac73dc8ebdb4c0faa4b3e789e5a8ab0">statistics</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> statistics_;}</div><div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#a2d00bd58ade2d412ca5ac2206d28fb89">  403</a></span>&#160;            <span class="keyword">const</span> std::vector&lt;double&gt; &amp;<a class="code" href="classalps_1_1gf_1_1itime__mesh.html#a2d00bd58ade2d412ca5ac2206d28fb89">points</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> points_;}</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#ada9ec27f9328de7791d32188193c8279">  406</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#ada9ec27f9328de7791d32188193c8279">operator!=</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html">itime_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <span class="keywordflow">return</span> !(*<span class="keyword">this</span>==mesh);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#a598fcf55a2a8aaaaf000f2f8ae603c6d">  411</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#a598fcf55a2a8aaaaf000f2f8ae603c6d">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)<span class="keyword"> const</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &lt;&lt; <span class="stringliteral">&quot;IMAGINARY_TIME&quot;</span>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                ar[path+<span class="stringliteral">&quot;/N&quot;</span>] &lt;&lt; ntau_;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                ar[path+<span class="stringliteral">&quot;/statistics&quot;</span>] &lt;&lt; int(statistics_); <span class="comment">//</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                ar[path+<span class="stringliteral">&quot;/beta&quot;</span>] &lt;&lt; beta_;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                ar[path+<span class="stringliteral">&quot;/half_point_mesh&quot;</span>] &lt;&lt; int(half_point_mesh_);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                ar[path+<span class="stringliteral">&quot;/last_point_included&quot;</span>] &lt;&lt; int(last_point_included_);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                ar[path+<span class="stringliteral">&quot;/points&quot;</span>] &lt;&lt; points_;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#a9d2585b0decef798b858117a80714df1">  423</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#a9d2585b0decef798b858117a80714df1">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                std::string kind;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &gt;&gt; kind;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                <span class="keywordflow">if</span> (kind!=<span class="stringliteral">&quot;IMAGINARY_TIME&quot;</span>) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempt to read Imaginary time mesh from non-itime data, kind=&quot;</span>+kind); <span class="comment">// FIXME: specific exception</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                <span class="keywordtype">double</span> ntau, beta;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <span class="keywordtype">int</span> stat, half_point_mesh, last_point_included;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                ar[path+<span class="stringliteral">&quot;/N&quot;</span>] &gt;&gt; ntau;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                ar[path+<span class="stringliteral">&quot;/statistics&quot;</span>] &gt;&gt; stat;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                ar[path+<span class="stringliteral">&quot;/beta&quot;</span>] &gt;&gt; beta;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                ar[path+<span class="stringliteral">&quot;/half_point_mesh&quot;</span>] &gt;&gt; half_point_mesh;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                ar[path+<span class="stringliteral">&quot;/last_point_included&quot;</span>] &gt;&gt; last_point_included;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                statistics_=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a>(stat); <span class="comment">// FIXME: check range</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                half_point_mesh_=half_point_mesh;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                last_point_included_=last_point_included;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                beta_=beta;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                ntau_=ntau;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                compute_points();</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#ae10d3c9eca3b192c06c4b3d382c0ee2f">  446</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#ae10d3c9eca3b192c06c4b3d382c0ee2f">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)<span class="keyword"> const</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#af7bd6d9b36671271f03c94f7cd0bd324">save</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#a73fa7b2db0dff03f6367cfee81af2f6f">  452</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#a73fa7b2db0dff03f6367cfee81af2f6f">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#ad7d3b93546b617b7dd2c737f41778de0">load</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="preprocessor">#ifdef ALPS_HAVE_MPI</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;          <span class="keywordtype">void</span> <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a>&amp; comm, <span class="keywordtype">int</span> root)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <span class="keyword">using</span> <a class="code" href="namespacealps_1_1mpi.html#a4b3ef8026e4d4dd8ce8c0c6f05c1347f">alps::mpi::broadcast</a>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                <span class="keywordflow">if</span>(comm.<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>() == root) throw_if_empty();</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <span class="comment">// FIXME: introduce (debug-only?) consistency check, like type checking? akin to load()?</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, beta_, root);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, ntau_, root);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, last_point_included_, root);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, half_point_mesh_, root);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                <span class="keywordtype">int</span> stat=statistics_;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, stat, root);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                statistics_=<span class="keyword">static_cast&lt;</span><a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a><span class="keyword">&gt;</span>(stat);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                compute_points(); <span class="comment">// recompute points rather than sending them over MPI</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1itime__mesh.html#a3a5a542165642735070a8023ccd8ec46">  474</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html#a3a5a542165642735070a8023ccd8ec46">compute_points</a>(){</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                points_.resize(extent());</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="keywordflow">if</span>(half_point_mesh_){</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                  <span class="keywordtype">double</span> dtau=beta_/ntau_;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;ntau_;++i){</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                      points_[i]=(i+0.5)*dtau;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                  }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;ntau_;++i){</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                  <span class="keywordtype">double</span> dtau=last_point_included_?beta_/(ntau_-1):beta_/ntau_;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;ntau_;++i){</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                      points_[i]=i*dtau;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                  }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        };</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        std::ostream &amp;<a class="code" href="namespacealps_1_1gf.html#a0c072dc142db347cd3713f168f0789d8">operator&lt;&lt;</a>(std::ostream &amp;os, <span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1itime__mesh.html">itime_mesh</a> &amp;M);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html">  494</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classalps_1_1gf_1_1power__mesh.html">power_mesh</a> {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordtype">double</span> beta_;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="keywordtype">int</span> ntau_;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keywordtype">int</span> power_;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keywordtype">int</span> uniform_;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a> statistics_;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            std::vector&lt;double&gt; points_;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            std::vector&lt;double&gt; weights_;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="keyword">inline</span> <span class="keywordtype">void</span> throw_if_empty()<span class="keyword"> const </span>{</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                <span class="keywordflow">if</span> (extent() == 0) {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;power_mesh is empty&quot;</span>);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="keyword">public</span>:</div><div class="line"><a name="l00511"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#ab27723e073b4b42cf2b4b54980bbce3d">  511</a></span>&#160;            <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index&lt;power_mesh&gt;</a> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#ab27723e073b4b42cf2b4b54980bbce3d">index_type</a>;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a52a16b94d7cee249bd6cd2fe04c3c1fb">  513</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1power__mesh.html#a52a16b94d7cee249bd6cd2fe04c3c1fb">power_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html">power_mesh</a>&amp; rhs): beta_(rhs.beta_), power_(rhs.power_), uniform_(rhs.uniform_), statistics_(rhs.statistics_){</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;              compute_points();</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;              compute_weights();</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a7de1706b3f11d373cc9d10af37dd5ed8">  518</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1power__mesh.html#a7de1706b3f11d373cc9d10af37dd5ed8">power_mesh</a>(): beta_(0.0), ntau_(0), power_(0), uniform_(0), statistics_(statistics::<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">FERMIONIC</a>){</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#aae4b27521800097a89a553259921cd43">  521</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1power__mesh.html#aae4b27521800097a89a553259921cd43">power_mesh</a>(<span class="keywordtype">double</span> beta, <span class="keywordtype">int</span> power, <span class="keywordtype">int</span> uniform): beta_(beta), power_(power), uniform_(uniform), statistics_(statistics::<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">FERMIONIC</a>){</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;              compute_points();</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;              compute_weights();</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            }</div><div class="line"><a name="l00525"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a3dfc7e7c7fd73db4534833c90db3258c">  525</a></span>&#160;                <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#a3dfc7e7c7fd73db4534833c90db3258c">operator()</a>(index_type idx)<span class="keyword"> const </span>{</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                    throw_if_empty();</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    <span class="keywordflow">return</span> idx();</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                }</div><div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a4c4ac18efa01f5534fa326f69a2dc8f3">  531</a></span>&#160;                <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#a4c4ac18efa01f5534fa326f69a2dc8f3">extent</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> ntau_;}</div><div class="line"><a name="l00532"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a8459f2593f26d3d6cb1dd96589123b6d">  532</a></span>&#160;                <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#a8459f2593f26d3d6cb1dd96589123b6d">power</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> power_;}</div><div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#ab1249a3fc4d0103bd301a4d9939b6ce4">  533</a></span>&#160;                <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#ab1249a3fc4d0103bd301a4d9939b6ce4">uniform</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> uniform_;}</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a1ca1ac15df4f697a179bd71e385ad135">  536</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#a1ca1ac15df4f697a179bd71e385ad135">operator==</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html">power_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <span class="keywordflow">return</span> beta_==mesh.beta_ &amp;&amp; ntau_==mesh.ntau_ &amp;&amp; power_==mesh.power_ &amp;&amp;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    uniform_ == mesh.uniform_ &amp;&amp; statistics_==mesh.statistics_;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a34b9e727a10c580cb14e9755662110d0">  543</a></span>&#160;            <span class="keywordtype">double</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#a34b9e727a10c580cb14e9755662110d0">beta</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> beta_;}</div><div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a353ff35d78c16768db6b8db81208a4de">  544</a></span>&#160;            <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#a353ff35d78c16768db6b8db81208a4de">statistics</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> statistics_;}</div><div class="line"><a name="l00545"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a0235cc9d8115bc78519d9a4156fddda2">  545</a></span>&#160;            <span class="keyword">const</span> std::vector&lt;double&gt; &amp;<a class="code" href="classalps_1_1gf_1_1power__mesh.html#a0235cc9d8115bc78519d9a4156fddda2">points</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> points_;}</div><div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#aac36ab8f8f8e6b9ba99658d1c5d7a1e7">  546</a></span>&#160;            <span class="keyword">const</span> std::vector&lt;double&gt; &amp;<a class="code" href="classalps_1_1gf_1_1power__mesh.html#aac36ab8f8f8e6b9ba99658d1c5d7a1e7">weights</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> weights_;}</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#ad2dc4505fcc7ca7b8b6df3f99446b541">  549</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#ad2dc4505fcc7ca7b8b6df3f99446b541">operator!=</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html">power_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                <span class="keywordflow">return</span> !(*<span class="keyword">this</span>==mesh);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a1431dee5f120a4e3d9117f168abc5996">  554</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#a1431dee5f120a4e3d9117f168abc5996">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)<span class="keyword"> const</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &lt;&lt; <span class="stringliteral">&quot;IMAGINARY_TIME_POWER&quot;</span>;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                ar[path+<span class="stringliteral">&quot;/N&quot;</span>] &lt;&lt; ntau_;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                ar[path+<span class="stringliteral">&quot;/statistics&quot;</span>] &lt;&lt; int(statistics_); <span class="comment">//</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                ar[path+<span class="stringliteral">&quot;/beta&quot;</span>] &lt;&lt; beta_;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                ar[path+<span class="stringliteral">&quot;/power&quot;</span>] &lt;&lt; power_;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                ar[path+<span class="stringliteral">&quot;/uniform&quot;</span>] &lt;&lt; uniform_;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                ar[path+<span class="stringliteral">&quot;/points&quot;</span>] &lt;&lt; points_;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a909eca5d741a73be9709098cb0e040e6">  566</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#a909eca5d741a73be9709098cb0e040e6">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                std::string kind;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &gt;&gt; kind;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                <span class="keywordflow">if</span> (kind!=<span class="stringliteral">&quot;IMAGINARY_TIME_POWER&quot;</span>) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempt to read Imaginary time power mesh from non-itime power data, kind=&quot;</span>+kind); <span class="comment">// FIXME: specific exception</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                <span class="keywordtype">double</span> ntau, beta;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <span class="keywordtype">int</span> stat, power, uniform;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                ar[path+<span class="stringliteral">&quot;/N&quot;</span>] &gt;&gt; ntau;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                ar[path+<span class="stringliteral">&quot;/statistics&quot;</span>] &gt;&gt; stat;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                ar[path+<span class="stringliteral">&quot;/beta&quot;</span>] &gt;&gt; beta;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                ar[path+<span class="stringliteral">&quot;/power&quot;</span>] &gt;&gt; power;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                ar[path+<span class="stringliteral">&quot;/uniform&quot;</span>] &gt;&gt; uniform;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                statistics_=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a>(stat); <span class="comment">// FIXME: check range</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                power_=power;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                uniform_=uniform;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                beta_=beta;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                ntau_=ntau;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                compute_points();</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                compute_weights();</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#af6ac75f6ce527856a743403369df0c51">  590</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#af6ac75f6ce527856a743403369df0c51">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)<span class="keyword"> const</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#af7bd6d9b36671271f03c94f7cd0bd324">save</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            }</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a674aa7e99a519599981b575e380f9e1a">  596</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#a674aa7e99a519599981b575e380f9e1a">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            {</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#ad7d3b93546b617b7dd2c737f41778de0">load</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="preprocessor">#ifdef ALPS_HAVE_MPI</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          <span class="keywordtype">void</span> <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a>&amp; comm, <span class="keywordtype">int</span> root)</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                <span class="keyword">using</span> <a class="code" href="namespacealps_1_1mpi.html#a4b3ef8026e4d4dd8ce8c0c6f05c1347f">alps::mpi::broadcast</a>;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                <span class="keywordflow">if</span>(comm.<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>() == root) throw_if_empty();</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                <span class="comment">// FIXME: introduce (debug-only?) consistency check, like type checking? akin to load()?</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, beta_, root);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, ntau_, root);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, power_, root);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, uniform_, root);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                <span class="keywordtype">int</span> stat=statistics_;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, stat, root);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                statistics_=<span class="keyword">static_cast&lt;</span><a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a><span class="keyword">&gt;</span>(stat);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                compute_points(); <span class="comment">// recompute points rather than sending them over MPI</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                compute_weights();</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#a2c73ff2417badc37aefcb70f56b1f13a">  619</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#a2c73ff2417badc37aefcb70f56b1f13a">compute_points</a>(){</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;              <span class="comment">//create a power grid spacing</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;              <span class="keywordflow">if</span>(uniform_%2 !=0) <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Simpson weights in power grid only work for even uniform spacing.&quot;</span>);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;              std::vector&lt;double&gt; power_points;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;              power_points.push_back(0);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=power_;i&gt;=0;--i){</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                power_points.push_back(beta_*0.5*<a class="code" href="namespacealps_1_1numeric.html#af3b1d25e7f72c9af81930fc04ed8759b">std::pow</a>(2.,-i));</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;              }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=power_;i&gt;0;--i){</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                power_points.push_back(beta_*(1.-0.5*<a class="code" href="namespacealps_1_1numeric.html#af3b1d25e7f72c9af81930fc04ed8759b">std::pow</a>(2.,-i)));</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;              }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;              power_points.push_back(beta_);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;              std::sort(power_points.begin(),power_points.end());</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;              <span class="comment">//create the uniform grid within each power grid</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;             points_.resize(0);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;              <span class="keywordflow">for</span>(std::size_t i=0;i&lt;power_points.size()-1;++i){</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;uniform_;++j){</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                  <span class="keywordtype">double</span> dtau=(power_points[i+1]-power_points[i])/(<span class="keywordtype">double</span>)(uniform_);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                  points_.push_back(power_points[i]+dtau*j);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;              }</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;              points_.push_back(power_points.back());</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;              ntau_=points_.size();</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1power__mesh.html#ab4432632e42d113ca315d99dc8e4d78d">  645</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html#ab4432632e42d113ca315d99dc8e4d78d">compute_weights</a>(){</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;              weights_.resize(extent());</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;              weights_[0        ]=(points_[1]    -points_[0        ])/(2.*beta_);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;              weights_[extent()-1]=(points_.back()-points_[extent()-2])/(2.*beta_);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;extent()-1;++i){</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                weights_[i]=(points_[i+1]-points_[i-1])/(2.*beta_);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;              }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        };</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        std::ostream &amp;<a class="code" href="namespacealps_1_1gf.html#a0c072dc142db347cd3713f168f0789d8">operator&lt;&lt;</a>(std::ostream &amp;os, <span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1power__mesh.html">power_mesh</a> &amp;M);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">  659</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">momentum_realspace_index_mesh</a> {</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keyword">public</span>:</div><div class="line"><a name="l00661"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a8f38034dfbaa0a55e30e2f0370d3338c">  661</a></span>&#160;            <span class="keyword">typedef</span> boost::multi_array&lt;double,2&gt; <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a8f38034dfbaa0a55e30e2f0370d3338c">container_type</a>;</div><div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a6454b09d70641361693ea097c87a2c2c">  662</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a6454b09d70641361693ea097c87a2c2c">momentum_realspace_index_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">momentum_realspace_index_mesh</a>&amp; rhs) : points_(<a class="code" href="namespaceboost.html">boost</a>::extents[rhs.points_.shape()[0]][rhs.points_.shape()[1]]),</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                                                                      kind_(rhs.kind_){</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;              points_ = rhs.<a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#afd30e02bfa48fceb2fae6f73f7c83169">points_</a>;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            }</div><div class="line"><a name="l00666"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a5836ac26fcab1323f255837d953bba47">  666</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">momentum_realspace_index_mesh</a>&amp; <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a5836ac26fcab1323f255837d953bba47">operator=</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">momentum_realspace_index_mesh</a>&amp; rhs) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;              points_.resize(boost::extents[rhs.<a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#afd30e02bfa48fceb2fae6f73f7c83169">points_</a>.shape()[0]][rhs.<a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#afd30e02bfa48fceb2fae6f73f7c83169">points_</a>.shape()[1]]);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;              points_ = rhs.<a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#afd30e02bfa48fceb2fae6f73f7c83169">points_</a>;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;              kind_   = rhs.kind_;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;              <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keyword">protected</span>:</div><div class="line"><a name="l00673"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#afd30e02bfa48fceb2fae6f73f7c83169">  673</a></span>&#160;            container_type <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#afd30e02bfa48fceb2fae6f73f7c83169">points_</a>;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="keyword">private</span>:</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            std::string kind_;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <span class="keyword">inline</span> <span class="keywordtype">void</span> throw_if_empty()<span class="keyword"> const </span>{</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                <span class="keywordflow">if</span> (extent() == 0) {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;momentum_realspace_index_mesh is empty&quot;</span>);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                }</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            }</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="keyword">protected</span>:</div><div class="line"><a name="l00684"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#afd59455c192ca5ca12231c10df731516">  684</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#afd59455c192ca5ca12231c10df731516">momentum_realspace_index_mesh</a>(): points_(<a class="code" href="namespaceboost.html">boost</a>::extents[0][0]), kind_(<span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            {</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a89e8aae976aff5873b3c0290259c7dde">  688</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a89e8aae976aff5873b3c0290259c7dde">momentum_realspace_index_mesh</a>(<span class="keyword">const</span> std::string&amp; kind, <span class="keywordtype">int</span> ns,<span class="keywordtype">int</span> ndim): points_(<a class="code" href="namespaceboost.html">boost</a>::extents[ns][ndim]), kind_(kind)</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            {</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a4ff1b1ac50f690ba0b8186f9b0df09a5">  692</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a4ff1b1ac50f690ba0b8186f9b0df09a5">momentum_realspace_index_mesh</a>(<span class="keyword">const</span> std::string&amp; kind, <span class="keyword">const</span> container_type&amp; mesh_points): points_(mesh_points), kind_(kind)</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            {</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="keyword">public</span>:</div><div class="line"><a name="l00698"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#ab65b8d9d0a3c2c9352770e476ecc201e">  698</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#ab65b8d9d0a3c2c9352770e476ecc201e">extent</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> points_.shape()[0];}</div><div class="line"><a name="l00700"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a711ace1ec578066a79622dd357612c63">  700</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a711ace1ec578066a79622dd357612c63">dimension</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> points_.shape()[1];}</div><div class="line"><a name="l00702"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a2c92171efb17f1e6ad4fe4faa7956964">  702</a></span>&#160;            <span class="keyword">const</span> std::string &amp;<a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a2c92171efb17f1e6ad4fe4faa7956964">kind</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> kind_;}</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a86d1895f27a312d724f36073b0247d3c">  705</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a86d1895f27a312d724f36073b0247d3c">operator==</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">momentum_realspace_index_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                <span class="keywordflow">return</span> kind_ == mesh.kind_ &amp;&amp;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                    points_ == mesh.<a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#afd30e02bfa48fceb2fae6f73f7c83169">points_</a>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            }</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a7fec4ae2fca9bd3a9d72b7a61037c9de">  712</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a7fec4ae2fca9bd3a9d72b7a61037c9de">operator!=</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">momentum_realspace_index_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <span class="keywordflow">return</span> !(*<span class="keyword">this</span>==mesh);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            }</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a3af45d804a6f17397ad104196647f03f">  717</a></span>&#160;            <span class="keyword">const</span> container_type &amp;<a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a3af45d804a6f17397ad104196647f03f">points</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> points_;}</div><div class="line"><a name="l00718"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a4d39cdc54566ddd209dc1a0a1d9f0b2d">  718</a></span>&#160;            container_type &amp;<a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a4d39cdc54566ddd209dc1a0a1d9f0b2d">points</a>() {<span class="keywordflow">return</span> points_;}</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#aee12b0ec70d91f1c9e8fdc158c03396f">  720</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#aee12b0ec70d91f1c9e8fdc158c03396f">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)<span class="keyword"> const</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &lt;&lt; kind_;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                ar[path+<span class="stringliteral">&quot;/points&quot;</span>] &lt;&lt; points_;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            }</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a031f631f594cdd49eaec5a0f08de7127">  727</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a031f631f594cdd49eaec5a0f08de7127">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                std::string kind;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &gt;&gt; kind;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                <span class="keywordflow">if</span> (kind!=kind_) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempt to load momentum/realspace index mesh from incorrect mesh kind=&quot;</span>+kind+ <span class="stringliteral">&quot; (expected: &quot;</span>+kind_+<span class="stringliteral">&quot;)&quot;</span>);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                ar[path+<span class="stringliteral">&quot;/points&quot;</span>] &gt;&gt; points_;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#ab1980f722e42ff263fb8727930de0694">  736</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#ab1980f722e42ff263fb8727930de0694">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)<span class="keyword"> const</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#af7bd6d9b36671271f03c94f7cd0bd324">save</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a9454f9d96beeb85ba16a786c7cefeb5f">  742</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a9454f9d96beeb85ba16a786c7cefeb5f">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            {</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#ad7d3b93546b617b7dd2c737f41778de0">load</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            }</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="preprocessor">#ifdef ALPS_HAVE_MPI</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          <span class="keywordtype">void</span> <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a>&amp; comm, <span class="keywordtype">int</span> root)</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            {</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                <span class="keyword">using</span> <a class="code" href="namespacealps_1_1mpi.html#a4b3ef8026e4d4dd8ce8c0c6f05c1347f">alps::mpi::broadcast</a>;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                <span class="keywordflow">if</span> (comm.<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>()==root) {</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                  throw_if_empty();</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                }</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <span class="comment">// FIXME: introduce (debug-only?) consistency check, like type checking? akin to load()?</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                std::array&lt;size_t, 2&gt; sizes{{points_.shape()[0], points_.shape()[1]}};</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                <a class="code" href="namespacealps_1_1mpi.html#a4b3ef8026e4d4dd8ce8c0c6f05c1347f">alps::mpi::broadcast</a>(comm, &amp;sizes[0], 2, root);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                <span class="keywordflow">if</span> (comm.<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>()!=root) points_.resize(sizes);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                <a class="code" href="namespacealps_1_1mpi.html#a4b3ef8026e4d4dd8ce8c0c6f05c1347f">detail::broadcast</a>(comm, points_, root);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, kind_, root);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        };</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        std::ostream &amp;<a class="code" href="namespacealps_1_1gf.html#a0c072dc142db347cd3713f168f0789d8">operator&lt;&lt;</a>(std::ostream &amp;os, <span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">momentum_realspace_index_mesh</a> &amp;M);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__index__mesh.html">  768</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classalps_1_1gf_1_1momentum__index__mesh.html">momentum_index_mesh</a>: <span class="keyword">public</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">momentum_realspace_index_mesh</a> {</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">momentum_realspace_index_mesh</a> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">base_type</a>;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <span class="keyword">public</span>:</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__index__mesh.html#aea623ee14b2afa45dc3f7cc3c609e1ca">  773</a></span>&#160;            <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index&lt;momentum_index_mesh&gt;</a> <a class="code" href="classalps_1_1gf_1_1momentum__index__mesh.html#aea623ee14b2afa45dc3f7cc3c609e1ca">index_type</a>;</div><div class="line"><a name="l00774"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__index__mesh.html#ab51d457ce5efddff41fd0927edeb5b75">  774</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1momentum__index__mesh.html#ab51d457ce5efddff41fd0927edeb5b75">momentum_index_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1momentum__index__mesh.html">momentum_index_mesh</a>&amp; rhs) : base_type(rhs) {}</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__index__mesh.html#a7030e07070c46290cb127c5819bd92d3">  776</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1momentum__index__mesh.html">momentum_index_mesh</a>&amp; <a class="code" href="classalps_1_1gf_1_1momentum__index__mesh.html#a7030e07070c46290cb127c5819bd92d3">operator=</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1momentum__index__mesh.html">momentum_index_mesh</a>&amp; rhs) {</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;              base_type::operator=(rhs);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;              <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            }</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__index__mesh.html#a693c37fcea4a5b2ad49533c49e022388">  781</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1momentum__index__mesh.html#a693c37fcea4a5b2ad49533c49e022388">momentum_index_mesh</a>(): base_type(<span class="stringliteral">&quot;MOMENTUM_INDEX&quot;</span>,0,0)</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            }</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__index__mesh.html#aca9ec5d443064b7b159f4b76dabf1d57">  785</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1momentum__index__mesh.html#aca9ec5d443064b7b159f4b76dabf1d57">momentum_index_mesh</a>(<span class="keywordtype">int</span> ns,<span class="keywordtype">int</span> ndim): base_type(<span class="stringliteral">&quot;MOMENTUM_INDEX&quot;</span>,ns,ndim)</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__index__mesh.html#ae403b7fc5f288c1fbdeb2a03be84f0fb">  789</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1momentum__index__mesh.html#ae403b7fc5f288c1fbdeb2a03be84f0fb">momentum_index_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a8f38034dfbaa0a55e30e2f0370d3338c">container_type</a>&amp; mesh_points): base_type(<span class="stringliteral">&quot;MOMENTUM_INDEX&quot;</span>,mesh_points)</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            {</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            }</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1momentum__index__mesh.html#a5be9dc5ff1357feb487421e2c9d4ff02">  794</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1momentum__index__mesh.html#a5be9dc5ff1357feb487421e2c9d4ff02">operator()</a>(index_type idx)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> idx(); }</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        };</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__space__index__mesh.html">  797</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classalps_1_1gf_1_1real__space__index__mesh.html">real_space_index_mesh</a>: <span class="keyword">public</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">momentum_realspace_index_mesh</a> {</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">momentum_realspace_index_mesh</a> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">base_type</a>;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keyword">public</span>:</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__space__index__mesh.html#a2acc86677bcd5c694e3bf1928a175e7b">  802</a></span>&#160;            <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index&lt;momentum_index_mesh&gt;</a> <a class="code" href="classalps_1_1gf_1_1real__space__index__mesh.html#a2acc86677bcd5c694e3bf1928a175e7b">index_type</a>;</div><div class="line"><a name="l00803"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__space__index__mesh.html#a231ca3ffa1b3a5f09ae8fbcd049cc2a7">  803</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1real__space__index__mesh.html#a231ca3ffa1b3a5f09ae8fbcd049cc2a7">real_space_index_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1real__space__index__mesh.html">real_space_index_mesh</a>&amp; rhs) : base_type(rhs) {}</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__space__index__mesh.html#a5561f18c93b9b1666fcaa7502cc1d4c5">  805</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1real__space__index__mesh.html#a5561f18c93b9b1666fcaa7502cc1d4c5">real_space_index_mesh</a>(): base_type(<span class="stringliteral">&quot;REAL_SPACE_INDEX&quot;</span>,0,0)</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            {</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            }</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__space__index__mesh.html#a18175d16169a26947a83cab72d2c809f">  809</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1real__space__index__mesh.html#a18175d16169a26947a83cab72d2c809f">real_space_index_mesh</a>(<span class="keywordtype">int</span> ns,<span class="keywordtype">int</span> ndim): base_type(<span class="stringliteral">&quot;REAL_SPACE_INDEX&quot;</span>,ns,ndim)</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            {</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            }</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__space__index__mesh.html#afd3261478c8ac0fffdd970d0595479b6">  813</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1real__space__index__mesh.html#afd3261478c8ac0fffdd970d0595479b6">real_space_index_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a8f38034dfbaa0a55e30e2f0370d3338c">container_type</a>&amp; mesh_points): base_type(<span class="stringliteral">&quot;REAL_SPACE_INDEX&quot;</span>,mesh_points)</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1real__space__index__mesh.html#add2208bf9bd0d07c079fb6ef59b24435">  818</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1real__space__index__mesh.html#add2208bf9bd0d07c079fb6ef59b24435">operator()</a>(index_type idx)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> idx(); }</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        };</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html">  821</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classalps_1_1gf_1_1index__mesh.html">index_mesh</a> {</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <span class="keywordtype">int</span> npoints_;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            std::vector&lt;int&gt; points_;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="keyword">public</span>:</div><div class="line"><a name="l00825"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#a546e2ceef388a7b6280c89caf2fd329f">  825</a></span>&#160;            <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index&lt;index_mesh&gt;</a> <a class="code" href="classalps_1_1gf_1_1index__mesh.html#a546e2ceef388a7b6280c89caf2fd329f">index_type</a>;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#a6697d22fbddc3f026641cefd90c208b7">  827</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1index__mesh.html#a6697d22fbddc3f026641cefd90c208b7">index_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html">index_mesh</a>&amp; rhs) : npoints_(rhs.npoints_) {compute_points();}</div><div class="line"><a name="l00828"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#a5f2d101d5fceef5582d582cf32d67a2d">  828</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1index__mesh.html">index_mesh</a>&amp; <a class="code" href="classalps_1_1gf_1_1index__mesh.html#a5f2d101d5fceef5582d582cf32d67a2d">operator=</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html">index_mesh</a>&amp; rhs) {npoints_ = rhs.npoints_; compute_points();<span class="keywordflow">return</span> * <span class="keyword">this</span>;}</div><div class="line"><a name="l00829"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#aea88bb36fe9167edcf1c7aaee359581a">  829</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1index__mesh.html#aea88bb36fe9167edcf1c7aaee359581a">index_mesh</a>(): npoints_(0) { compute_points();}</div><div class="line"><a name="l00830"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#aa18971273af47106a562fcde97f6a712">  830</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1index__mesh.html#aa18971273af47106a562fcde97f6a712">index_mesh</a>(<span class="keywordtype">int</span> np): npoints_(np) { compute_points();}</div><div class="line"><a name="l00831"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#a93be73af8f719e74b554bf277f76a08b">  831</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html#a93be73af8f719e74b554bf277f76a08b">extent</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> npoints_;}</div><div class="line"><a name="l00832"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#a4d6ee24eba6f11e91ea18058ab89cd35">  832</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html#a4d6ee24eba6f11e91ea18058ab89cd35">operator()</a>(index_type idx)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> idx(); }</div><div class="line"><a name="l00833"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#aa6b6db05b56f164c0a4c069c15d1c3e1">  833</a></span>&#160;            <span class="keyword">const</span> std::vector&lt;int&gt; &amp;<a class="code" href="classalps_1_1gf_1_1index__mesh.html#aa6b6db05b56f164c0a4c069c15d1c3e1">points</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> points_;}</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#aa381fd285534908e04fbcfe63c679b6d">  835</a></span>&#160;            <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html#aa381fd285534908e04fbcfe63c679b6d">throw_if_empty</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                <span class="keywordflow">if</span> (extent() == 0) {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;index_mesh is empty&quot;</span>);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#a9890a39a66c49fa29d5e291cff809dc5">  842</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html#a9890a39a66c49fa29d5e291cff809dc5">operator==</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html">index_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                <span class="keywordflow">return</span> npoints_==mesh.npoints_;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            }</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#ad430566914bc1f521ab6a967d250345a">  848</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html#ad430566914bc1f521ab6a967d250345a">operator!=</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html">index_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                <span class="keywordflow">return</span> !(*<span class="keyword">this</span>==mesh);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#a25704acb7d3f148752223ff3163cd768">  853</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html#a25704acb7d3f148752223ff3163cd768">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)<span class="keyword"> const</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &lt;&lt; <span class="stringliteral">&quot;INDEX&quot;</span>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                ar[path+<span class="stringliteral">&quot;/N&quot;</span>] &lt;&lt; npoints_;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#a9fc4a570305c7158c84de5bb95ac779e">  860</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html#a9fc4a570305c7158c84de5bb95ac779e">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            {</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                std::string kind;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &gt;&gt; kind;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                <span class="keywordflow">if</span> (kind!=<span class="stringliteral">&quot;INDEX&quot;</span>) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempt to read Index mesh from non-Index data, kind=&quot;</span>+kind); <span class="comment">// FIXME: specific exception</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                <span class="keywordtype">int</span> np;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                ar[path+<span class="stringliteral">&quot;/N&quot;</span>] &gt;&gt; np;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                npoints_=np;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                compute_points();</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#a143d61f265b1402146ea5ae7591972ed">  873</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html#a143d61f265b1402146ea5ae7591972ed">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)<span class="keyword"> const</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#af7bd6d9b36671271f03c94f7cd0bd324">save</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#a36c55dc6b034ba7a7d0ac22b31af9cbb">  879</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html#a36c55dc6b034ba7a7d0ac22b31af9cbb">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            {</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#ad7d3b93546b617b7dd2c737f41778de0">load</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            }</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1index__mesh.html#a51bf2f66013c93e75c2ffcf11fe8b226">  884</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html#a51bf2f66013c93e75c2ffcf11fe8b226">compute_points</a>(){ points_.resize(npoints_); <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;npoints_;++i){points_[i]=i;} }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="preprocessor">#ifdef ALPS_HAVE_MPI</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          <span class="keywordtype">void</span> <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a>&amp; comm, <span class="keywordtype">int</span> root)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            {</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                <span class="keyword">using</span> <a class="code" href="namespacealps_1_1mpi.html#a4b3ef8026e4d4dd8ce8c0c6f05c1347f">alps::mpi::broadcast</a>;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                <span class="keywordflow">if</span>(comm.<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>() == root) throw_if_empty();</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, npoints_, root);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                compute_points();</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            }</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        };</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        std::ostream &amp;<a class="code" href="namespacealps_1_1gf.html#a0c072dc142db347cd3713f168f0789d8">operator&lt;&lt;</a>(std::ostream &amp;os, <span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1index__mesh.html">index_mesh</a> &amp;M);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html">  899</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classalps_1_1gf_1_1legendre__mesh.html">legendre_mesh</a> : <span class="keyword">public</span> <a class="code" href="classalps_1_1gf_1_1base__mesh.html">base_mesh</a> {</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <span class="keywordtype">double</span> beta_;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordtype">int</span> n_max_;<span class="comment">//number of legendre polynomials</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a> statistics_;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <span class="keyword">inline</span> <span class="keywordtype">void</span> throw_if_empty()<span class="keyword"> const </span>{</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                <span class="keywordflow">if</span> (extent() == 0) {</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;legendre_mesh is empty&quot;</span>);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            }</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keyword">public</span>:</div><div class="line"><a name="l00912"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#ae19e4d5a7abb05805c4ba725a626798a">  912</a></span>&#160;            <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index&lt;legendre_mesh&gt;</a> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#ae19e4d5a7abb05805c4ba725a626798a">index_type</a>;</div><div class="line"><a name="l00913"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#aee39d45390464e4236427063351bd6e4">  913</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#aee39d45390464e4236427063351bd6e4">legendre_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html">legendre_mesh</a>&amp; rhs) : beta_(rhs.beta_), n_max_(rhs.n_max_), statistics_(rhs.statistics_) {compute_points();}</div><div class="line"><a name="l00914"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#a3f288069e50035c683a014ac95a9b60f">  914</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#a3f288069e50035c683a014ac95a9b60f">legendre_mesh</a>(<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">gf::statistics::statistics_type</a> statistics=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">statistics::FERMIONIC</a>):</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                    beta_(0.0), n_max_(0), statistics_(statistics) {}</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#a9ddf0990dc84fc1d73a3ba4a4a71c7d9">  917</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#a9ddf0990dc84fc1d73a3ba4a4a71c7d9">legendre_mesh</a>(<span class="keywordtype">double</span> b, <span class="keywordtype">int</span> n_max, <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">gf::statistics::statistics_type</a> statistics=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">statistics::FERMIONIC</a>):</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                    beta_(b), n_max_(n_max), statistics_(statistics) {</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                check_range();</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                compute_points();</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            }</div><div class="line"><a name="l00922"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#a9693cd11e9782fc02c242f23812f7306">  922</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#a9693cd11e9782fc02c242f23812f7306">extent</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> n_max_;}</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#ad52fae0ed407952749b5e78ed4489f77">  924</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#ad52fae0ed407952749b5e78ed4489f77">operator()</a>(index_type idx)<span class="keyword"> const </span>{</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                <span class="keywordflow">return</span> idx();</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            }</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00932"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#a58dbd96914103c6f2940a69e6db2c1d8">  932</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#a58dbd96914103c6f2940a69e6db2c1d8">operator==</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html">legendre_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                <span class="keywordflow">return</span> beta_==mesh.beta_ &amp;&amp; n_max_==mesh.n_max_ &amp;&amp; statistics_==mesh.statistics_;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            }</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#a38a1aa679ad6e5bd55a8031030632743">  938</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#a38a1aa679ad6e5bd55a8031030632743">operator!=</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html">legendre_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                <span class="keywordflow">return</span> !(*<span class="keyword">this</span>==mesh);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            }</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#aef781f2408715fe6aeb566231a76ce70">  944</a></span>&#160;            <span class="keywordtype">double</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#aef781f2408715fe6aeb566231a76ce70">beta</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> beta_;}</div><div class="line"><a name="l00945"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#a964232d56fa57f437e212795615e7543">  945</a></span>&#160;            <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#a964232d56fa57f437e212795615e7543">statistics</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> statistics_;}</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <span class="comment">// It&#39;s a member function to avoid dealing with templated friend decalration.</span></div><div class="line"><a name="l00949"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#ad6485679a3acb328cd4a591220d93427">  949</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#ad6485679a3acb328cd4a591220d93427">swap</a>(<a class="code" href="classalps_1_1gf_1_1legendre__mesh.html">legendre_mesh</a>&amp; other) {</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                <span class="keyword">using</span> <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">std::swap</a>;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                <span class="keywordflow">if</span> (this-&gt;statistics_ != other.statistics_) {</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempt to swap LEGENDRE meshes with different statistics&quot;</span>);</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">swap</a>(this-&gt;beta_, other.beta_);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">swap</a>(this-&gt;n_max_, other.n_max_);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                <a class="code" href="classalps_1_1gf_1_1base__mesh.html#aa568cbdc80f04312e070eaa12187691a">base_mesh::swap</a>(other);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#a943bef15606fe840781ac73b738bab8f">  960</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#a943bef15606fe840781ac73b738bab8f">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)<span class="keyword"> const</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                throw_if_empty();</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &lt;&lt; <span class="stringliteral">&quot;LEGENDRE&quot;</span>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                ar[path+<span class="stringliteral">&quot;/N&quot;</span>] &lt;&lt; n_max_;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                ar[path+<span class="stringliteral">&quot;/statistics&quot;</span>] &lt;&lt; int(statistics_);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                ar[path+<span class="stringliteral">&quot;/beta&quot;</span>] &lt;&lt; beta_;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            }</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#a27179aa34156cadedd38a0d589093464">  969</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#a27179aa34156cadedd38a0d589093464">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            {</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                std::string kind;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &gt;&gt; kind;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                <span class="keywordflow">if</span> (kind!=<span class="stringliteral">&quot;LEGENDRE&quot;</span>) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempt to read LEGENDRE mesh from non-LEGENDRE data, kind=&quot;</span>+kind); <span class="comment">// FIXME: specific exception</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <span class="keywordtype">double</span> n_max, beta;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                <span class="keywordtype">int</span> stat;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                ar[path+<span class="stringliteral">&quot;/N&quot;</span>] &gt;&gt; n_max;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                ar[path+<span class="stringliteral">&quot;/statistics&quot;</span>] &gt;&gt; stat;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                ar[path+<span class="stringliteral">&quot;/beta&quot;</span>] &gt;&gt; beta;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                statistics_=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a>(stat);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                beta_=beta;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                n_max_=n_max;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                check_range();</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                compute_points();</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            }</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#a168126f993e995158aadfa7affbbf462">  989</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#a168126f993e995158aadfa7affbbf462">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)<span class="keyword"> const</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#af7bd6d9b36671271f03c94f7cd0bd324">save</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            }</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#ab82540ace227b2944f44f29c1952aacf">  995</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#ab82540ace227b2944f44f29c1952aacf">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            {</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#ad7d3b93546b617b7dd2c737f41778de0">load</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            }</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="preprocessor">#ifdef ALPS_HAVE_MPI</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            <span class="keywordtype">void</span> <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a>&amp; comm, <span class="keywordtype">int</span> root)</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            {</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                <span class="keyword">using</span> <a class="code" href="namespacealps_1_1mpi.html#a4b3ef8026e4d4dd8ce8c0c6f05c1347f">alps::mpi::broadcast</a>;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                <span class="keywordflow">if</span>(comm.<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>() == root) throw_if_empty();</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, beta_, root);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, n_max_, root);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                {</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                    <span class="keywordtype">int</span> stat = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(statistics_);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                    <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, stat, root);</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                    statistics_=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a>(stat);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                }</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                <span class="keywordflow">try</span> {</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                    check_range();</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; exc) {</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                    <span class="comment">// FIXME? Try to communiucate the error with all ranks, at least in debug mode?</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                    <span class="keywordtype">int</span> wrank=<a class="code" href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a>().<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>();</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                    std::cerr &lt;&lt; <span class="stringliteral">&quot;legendre_mesh&lt;&gt;::broadcast() exception at WORLD rank=&quot;</span> &lt;&lt; wrank &lt;&lt; std::endl</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                              &lt;&lt; exc.what()</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;\nAborting.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                    MPI_Abort(MPI_COMM_WORLD,1);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                }</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                compute_points(); <span class="comment">// recompute points rather than sending them over MPI</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            }</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div><div class="line"><a name="l01027"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#a41aceaf617500748df0c0e144bd72d5e"> 1027</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#a41aceaf617500748df0c0e144bd72d5e">check_range</a>(){</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                <span class="keywordflow">if</span>(statistics_!=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">statistics::FERMIONIC</a> &amp;&amp; statistics_!=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992a5186b8900b5e2ef2a9316840d7463c6f">statistics::BOSONIC</a>) <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;statistics should be bosonic or fermionic&quot;</span>);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            }</div><div class="line"><a name="l01030"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1legendre__mesh.html#a3f2276269a2c84b1e6ea14440b1bac94"> 1030</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html#a3f2276269a2c84b1e6ea14440b1bac94">compute_points</a>(){</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                <span class="comment">//This is sort of trivial in the current implementation.</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                <span class="comment">//We use P_0, P_1, P_2, ..., P_{n_max_-1}</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                _points().resize(extent());</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;n_max_;++i){</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                    _points()[i]=i;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                }</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            }</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        };</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        std::ostream &amp;<a class="code" href="namespacealps_1_1gf.html#a0c072dc142db347cd3713f168f0789d8">operator&lt;&lt;</a>(std::ostream &amp;os, <span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1legendre__mesh.html">legendre_mesh</a> &amp;M);</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l01046"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html"> 1046</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classalps_1_1gf_1_1numerical__mesh.html">numerical_mesh</a> : <span class="keyword">public</span> <a class="code" href="classalps_1_1gf_1_1base__mesh.html">base_mesh</a> {</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <span class="keywordtype">double</span> beta_;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            <span class="keywordtype">int</span> dim_;<span class="comment">//dimension of the basis</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a> statistics_;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            std::vector&lt;piecewise_polynomial&lt;T&gt; &gt; basis_functions_;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            <span class="keywordtype">bool</span> valid_;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            <span class="keywordtype">void</span> set_validity() {</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                valid_ = <span class="keyword">true</span>;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                valid_ = valid_ &amp;&amp; dim_ &gt; 0;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                valid_ = valid_ &amp;&amp; std::size_t(dim_) == basis_functions_.size();</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                valid_ = valid_ &amp;&amp; beta_ &gt;= 0.0;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                valid_ = valid_ &amp;&amp; (statistics_==<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">statistics::FERMIONIC</a> || statistics_==<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992a5186b8900b5e2ef2a9316840d7463c6f">statistics::BOSONIC</a>);</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                <span class="keywordflow">if</span> (basis_functions_.size() &gt; 1u) {</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                    <span class="keywordflow">for</span> (std::size_t l=0; l &lt; basis_functions_.size()-1; ++l) {</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                        valid_ = valid_ &amp;&amp; (basis_functions_[l].section_edges() == basis_functions_[l+1].section_edges());</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                    }</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                }</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            }</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            <span class="keywordtype">void</span> check_validity()<span class="keyword"> const </span>{</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                <span class="keywordflow">if</span> (!valid_) {</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;numerical mesh has not been properly constructed!&quot;</span>);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            }</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="keyword">public</span>:</div><div class="line"><a name="l01077"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a604856b11948e7b477bf0b02cebd037b"> 1077</a></span>&#160;            <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">generic_index&lt;numerical_mesh&gt;</a> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a604856b11948e7b477bf0b02cebd037b">index_type</a>;</div><div class="line"><a name="l01078"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a9dae02578baeabbd23589eb689358260"> 1078</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a9dae02578baeabbd23589eb689358260">numerical_mesh</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html">numerical_mesh&lt;T&gt;</a>&amp; rhs) : beta_(rhs.beta_), dim_(rhs.dim_), basis_functions_(rhs.basis_functions_), statistics_(rhs.statistics_), valid_(rhs.valid_) {</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                set_validity();</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                compute_points();</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            }</div><div class="line"><a name="l01082"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a9ffeca4c79882350585c63db5ea0b311"> 1082</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a9ffeca4c79882350585c63db5ea0b311">numerical_mesh</a>(<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">gf::statistics::statistics_type</a> statistics=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">statistics::FERMIONIC</a>):</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                    beta_(0.0), dim_(0), statistics_(statistics), basis_functions_(), valid_(false) {}</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a1fb434b15f95d0b3d8ad56ff99d26567"> 1085</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a1fb434b15f95d0b3d8ad56ff99d26567">numerical_mesh</a>(<span class="keywordtype">double</span> b,  <span class="keyword">const</span> std::vector&lt;<a class="code" href="classalps_1_1gf_1_1piecewise__polynomial.html">piecewise_polynomial&lt;T&gt;</a> &gt;&amp;basis_functions,</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                           <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">gf::statistics::statistics_type</a> statistics=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">statistics::FERMIONIC</a>):</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                    beta_(b), dim_(basis_functions.<a class="code" href="namespacealps.html#ad18068978b72b94a2ba76995d8afc022">size</a>()), statistics_(statistics), basis_functions_(basis_functions), valid_(false) {</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                set_validity();</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                <span class="comment">//check_range();</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                compute_points();</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            }</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a69bca9e50ff230a1505aa26974bfece7"> 1093</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a69bca9e50ff230a1505aa26974bfece7">extent</a>()<span class="keyword"> const</span>{</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                check_validity();</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                <span class="keywordflow">return</span> dim_;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            }</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a7ad7715b4f67e5da8e686ec33503609d"> 1098</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a7ad7715b4f67e5da8e686ec33503609d">operator()</a>(index_type idx)<span class="keyword"> const </span>{</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                check_validity();</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                <span class="keywordflow">return</span> idx();</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a88f81b1c3187e57197326aeafde8bb8c"> 1104</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a88f81b1c3187e57197326aeafde8bb8c">operator==</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html">numerical_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                check_validity();</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                <span class="keywordflow">return</span> beta_==mesh.beta_ &amp;&amp; dim_==mesh.dim_ &amp;&amp; statistics_==mesh.statistics_ &amp;&amp; basis_functions_==mesh.basis_functions_;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#ae6ed8c9c415c5f91a14f519444c23938"> 1110</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#ae6ed8c9c415c5f91a14f519444c23938">operator!=</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html">numerical_mesh</a> &amp;mesh)<span class="keyword"> const </span>{</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                check_validity();</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                <span class="keywordflow">return</span> !(*<span class="keyword">this</span>==mesh);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a713e9fa9f5bb45046532c6a7f511f29e"> 1116</a></span>&#160;            <span class="keywordtype">double</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a713e9fa9f5bb45046532c6a7f511f29e">beta</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> beta_;}</div><div class="line"><a name="l01117"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a4630115a2a8f0d28a20b16d5e5dda01c"> 1117</a></span>&#160;            <a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a4630115a2a8f0d28a20b16d5e5dda01c">statistics</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> statistics_;}</div><div class="line"><a name="l01118"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a1c52d76dd9ea0d6a506622d399b4df02"> 1118</a></span>&#160;            <span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1piecewise__polynomial.html">piecewise_polynomial&lt;T&gt;</a>&amp; <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a1c52d76dd9ea0d6a506622d399b4df02">basis_function</a>(<span class="keywordtype">int</span> l)<span class="keyword"> const </span>{</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                assert(l&gt;=0 &amp;&amp; l &lt; dim_);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                check_validity();</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                <span class="keywordflow">return</span> basis_functions_[l];</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            }</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            <span class="comment">// It&#39;s a member function to avoid dealing with templated friend decalration.</span></div><div class="line"><a name="l01127"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a6a2e5f8f2b1d7a06add055517f001ebe"> 1127</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a6a2e5f8f2b1d7a06add055517f001ebe">swap</a>(<a class="code" href="classalps_1_1gf_1_1numerical__mesh.html">numerical_mesh</a>&amp; other) {</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                <span class="keyword">using</span> <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">std::swap</a>;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                check_validity();</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">swap</a>(this-&gt;beta_, other.beta_);</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">swap</a>(this-&gt;dim_, other.dim_);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                <span class="keywordflow">if</span> (this-&gt;statistics_ != other.statistics_) {</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Do not swap numerical meshes with different statistics!&quot;</span>);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                }</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                <a class="code" href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">swap</a>(this-&gt;basis_functions_, other.basis_functions_);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                <a class="code" href="classalps_1_1gf_1_1base__mesh.html#aa568cbdc80f04312e070eaa12187691a">base_mesh::swap</a>(other);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            }</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#abe7e57316de423a074ef3911f87cc733"> 1139</a></span>&#160;            <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html">numerical_mesh</a>&amp; <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#abe7e57316de423a074ef3911f87cc733">operator=</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html">numerical_mesh</a>&amp; other) {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                this-&gt;beta_ = other.beta_;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                this-&gt;dim_ = other.dim_;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                this-&gt;statistics_ = other.statistics_;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                this-&gt;basis_functions_ = other.basis_functions_;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                base_mesh::operator=(other);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a3e7922e3dcb675cd4369574beefe0440"> 1147</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a3e7922e3dcb675cd4369574beefe0440">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)<span class="keyword"> const</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                check_validity();</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &lt;&lt; <span class="stringliteral">&quot;NUMERICAL_MESH&quot;</span>;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                ar[path+<span class="stringliteral">&quot;/N&quot;</span>] &lt;&lt; dim_;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                ar[path+<span class="stringliteral">&quot;/statistics&quot;</span>] &lt;&lt; int(statistics_);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                ar[path+<span class="stringliteral">&quot;/beta&quot;</span>] &lt;&lt; beta_;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l=0; l &lt; dim_; ++l) {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                    basis_functions_[l].save(ar, path+<span class="stringliteral">&quot;/basis_functions&quot;</span>+std::to_string(l));</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                }</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            }</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a78bf46a840749911b49fb70cbc343c48"> 1159</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a78bf46a840749911b49fb70cbc343c48">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar, <span class="keyword">const</span> std::string&amp; path)</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            {</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                std::string kind;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                ar[path+<span class="stringliteral">&quot;/kind&quot;</span>] &gt;&gt; kind;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                <span class="keywordflow">if</span> (kind!=<span class="stringliteral">&quot;NUMERICAL_MESH&quot;</span>) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempt to read NUMERICAL_MESH mesh from non-numerical-mesh data, kind=&quot;</span>+kind); <span class="comment">// FIXME: specific exception</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                <span class="keywordtype">double</span> dim, beta;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                <span class="keywordtype">int</span> stat;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                ar[path+<span class="stringliteral">&quot;/N&quot;</span>] &gt;&gt; dim;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                ar[path+<span class="stringliteral">&quot;/statistics&quot;</span>] &gt;&gt; stat;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                <span class="keywordflow">if</span> (valid_ &amp;&amp; stat != statistics_) {</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attemp to load data with different statistics!&quot;</span>);</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                }</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                ar[path+<span class="stringliteral">&quot;/beta&quot;</span>] &gt;&gt; beta;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                basis_functions_.resize(dim);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l=0; l &lt; dim; ++l) {</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                    basis_functions_[l].load(ar, path+<span class="stringliteral">&quot;/basis_functions&quot;</span>+std::to_string(l));</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                }</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                statistics_ = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a><span class="keyword">&gt;</span>(stat);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                beta_=beta;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                dim_=dim;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                set_validity();</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                compute_points();</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            }</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01187"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#afd06518d4690757791cb75aa4a8294a8"> 1187</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#afd06518d4690757791cb75aa4a8294a8">save</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)<span class="keyword"> const</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="keyword">            </span>{</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#af7bd6d9b36671271f03c94f7cd0bd324">save</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            }</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a949dd4f4424662320b8e7d1d1d13760d"> 1193</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a949dd4f4424662320b8e7d1d1d13760d">load</a>(<a class="code" href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a>&amp; ar)</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            {</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                <a class="code" href="namespacealps_1_1hdf5.html#ad7d3b93546b617b7dd2c737f41778de0">load</a>(ar, ar.<a class="code" href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">get_context</a>());</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            }</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="preprocessor">#ifdef ALPS_HAVE_MPI</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            <span class="keywordtype">void</span> <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(<span class="keyword">const</span> <a class="code" href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a>&amp; comm, <span class="keywordtype">int</span> root)</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            {</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                <span class="keyword">using</span> <a class="code" href="namespacealps_1_1mpi.html#a4b3ef8026e4d4dd8ce8c0c6f05c1347f">alps::mpi::broadcast</a>;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                <span class="keywordflow">if</span>(comm.<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>() == root) check_validity();</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, beta_, root);</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, dim_, root);</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                {</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                    <span class="keywordtype">int</span> stat = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(statistics_);</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                    <a class="code" href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">broadcast</a>(comm, stat, root);</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                    statistics_=<a class="code" href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">statistics::statistics_type</a>(stat);</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                }</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                basis_functions_.resize(dim_);</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l=0; l &lt; dim_; ++l) {</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                    basis_functions_[l].broadcast(comm, root);</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                }</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                set_validity();</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                <span class="keywordflow">try</span> {</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                    check_validity();</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; exc) {</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                    <span class="comment">// FIXME? Try to communiucate the error with all ranks, at least in debug mode?</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                    <span class="keywordtype">int</span> wrank=<a class="code" href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a>().<a class="code" href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">rank</a>();</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                    std::cerr &lt;&lt; <span class="stringliteral">&quot;numerical_mesh&lt;&gt;::broadcast() exception at WORLD rank=&quot;</span> &lt;&lt; wrank &lt;&lt; std::endl</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                              &lt;&lt; exc.what()</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;\nAborting.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                    MPI_Abort(MPI_COMM_WORLD,1);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                }</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                compute_points(); <span class="comment">// recompute points rather than sending them over MPI</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            }</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"><a class="line" href="classalps_1_1gf_1_1numerical__mesh.html#a27c570aec1421c84e91a64d320c15634"> 1232</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="classalps_1_1gf_1_1numerical__mesh.html#a27c570aec1421c84e91a64d320c15634">compute_points</a>(){</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                _points().resize(extent());</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;dim_;++i){</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                    _points()[i]=i;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                }</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            }</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        };</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#acacb860ecd3deac3713fac28a6018e69"> 1240</a></span>&#160;        <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html">matsubara_mesh&lt;mesh::POSITIVE_ONLY&gt;</a> <a class="code" href="namespacealps_1_1gf.html#acacb860ecd3deac3713fac28a6018e69">matsubara_positive_mesh</a>;</div><div class="line"><a name="l01241"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#ad035c882ae5b0716b03f30c2efdf8c25"> 1241</a></span>&#160;        <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1matsubara__mesh.html">matsubara_mesh&lt;mesh::POSITIVE_NEGATIVE&gt;</a> <a class="code" href="namespacealps_1_1gf.html#ad035c882ae5b0716b03f30c2efdf8c25">matsubara_pn_mesh</a>;</div><div class="line"><a name="l01242"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#a83e4dd3b179e3e0f771df3a63589242d"> 1242</a></span>&#160;        <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">matsubara_mesh&lt;mesh::POSITIVE_ONLY&gt;::index_type</a> <a class="code" href="namespacealps_1_1gf.html#a83e4dd3b179e3e0f771df3a63589242d">matsubara_index</a>;</div><div class="line"><a name="l01243"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#a39922e64f2469331acd41907559e06f9"> 1243</a></span>&#160;        <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">matsubara_mesh&lt;mesh::POSITIVE_NEGATIVE&gt;::index_type</a> <a class="code" href="namespacealps_1_1gf.html#a39922e64f2469331acd41907559e06f9">matsubara_pn_index</a>;</div><div class="line"><a name="l01244"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#af8914c4cead3b52638515f4e7da935d4"> 1244</a></span>&#160;        <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">itime_mesh::index_type</a> <a class="code" href="namespacealps_1_1gf.html#af8914c4cead3b52638515f4e7da935d4">itime_index</a>;</div><div class="line"><a name="l01245"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#a0d95056f15a31f09074e923af11ea31e"> 1245</a></span>&#160;        <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">momentum_index_mesh::index_type</a> <a class="code" href="namespacealps_1_1gf.html#a0d95056f15a31f09074e923af11ea31e">momentum_index</a>;</div><div class="line"><a name="l01246"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#a6d144afe8c73111c4a079164fafac7bc"> 1246</a></span>&#160;        <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">real_space_index_mesh::index_type</a> <a class="code" href="namespacealps_1_1gf.html#a6d144afe8c73111c4a079164fafac7bc">real_space_index</a>;</div><div class="line"><a name="l01247"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#ace8c82e4ab9e996445dd6b70af3cdd51"> 1247</a></span>&#160;        <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">index_mesh::index_type</a> <a class="code" href="namespacealps_1_1gf.html#ace8c82e4ab9e996445dd6b70af3cdd51">index</a>;</div><div class="line"><a name="l01248"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#a71cceb67c6804dae9c372b333e5af3cc"> 1248</a></span>&#160;        <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">real_frequency_mesh::index_type</a> <a class="code" href="namespacealps_1_1gf.html#a71cceb67c6804dae9c372b333e5af3cc">real_freq_index</a>;</div><div class="line"><a name="l01249"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#aae7b9ad0a60c0128ecb1415dc82ebcf7"> 1249</a></span>&#160;        <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">legendre_mesh::index_type</a> <a class="code" href="namespacealps_1_1gf.html#aae7b9ad0a60c0128ecb1415dc82ebcf7">legendre_index</a>;</div><div class="line"><a name="l01250"></a><span class="lineno"><a class="line" href="namespacealps_1_1gf.html#af1f3b5992d1f43105dc01829f696a20c"> 1250</a></span>&#160;        <span class="keyword">typedef</span> <a class="code" href="classalps_1_1gf_1_1generic__index.html">numerical_mesh&lt;double&gt;::index_type</a> <a class="code" href="namespacealps_1_1gf.html#af1f3b5992d1f43105dc01829f696a20c">numerical_mesh_index</a>;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <span class="keyword">namespace </span>detail {</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            <span class="comment">/* The following is an in-house implementation of a static_assert</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">               with the intent to generate a compile-time error message</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">               that has some relevance to the asserted condition</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">               (unlike BOOST_STATIC_ASSERT).</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">            */</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            <span class="keyword">struct </span>can_have_tail_yes { <span class="keyword">typedef</span> <span class="keywordtype">bool</span> mesh_can_have_tail; };</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <span class="keyword">struct </span>can_have_tail_no  { <span class="keyword">typedef</span> <span class="keywordtype">bool</span> mesh_cannot_have_tail; };</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            <span class="keyword">template</span> &lt;<span class="keyword">typename</span>&gt; <span class="keyword">struct </span>can_have_tail: <span class="keyword">public</span> can_have_tail_no {};</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            <span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>can_have_tail&lt;matsubara_positive_mesh&gt;: <span class="keyword">public</span> can_have_tail_yes {};</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            <span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>can_have_tail&lt;matsubara_pn_mesh&gt;: <span class="keyword">public</span> can_have_tail_yes {};</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            <span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>can_have_tail&lt;itime_mesh&gt;: <span class="keyword">public</span> can_have_tail_yes {};</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            <span class="comment">/* ^^^^ End of static_assert code */</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            std::ostream&amp; operator&lt;&lt;(std::ostream&amp; s, const boost::multi_array&lt;double, 1&gt;&amp; data);</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        } <span class="comment">// ::detail</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    }</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;}</div><div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_ab1249a3fc4d0103bd301a4d9939b6ce4"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#ab1249a3fc4d0103bd301a4d9939b6ce4">alps::gf::power_mesh::uniform</a></div><div class="ttdeci">int uniform() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00533">mesh.hpp:533</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_a546e2ceef388a7b6280c89caf2fd329f"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#a546e2ceef388a7b6280c89caf2fd329f">alps::gf::index_mesh::index_type</a></div><div class="ttdeci">generic_index&lt; index_mesh &gt; index_type</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00825">mesh.hpp:825</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1generic__index_html_a411caf4e4f4cba02dcd1ef09778e37fb"><div class="ttname"><a href="classalps_1_1gf_1_1generic__index.html#a411caf4e4f4cba02dcd1ef09778e37fb">alps::gf::generic_index::operator&gt;</a></div><div class="ttdeci">bool operator&gt;(int x) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00059">mesh.hpp:59</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html_a3b5999ed6f4bc7b79a8330a193200569"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html#a3b5999ed6f4bc7b79a8330a193200569">alps::gf::real_frequency_mesh::operator==</a></div><div class="ttdeci">bool operator==(const real_frequency_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00146">mesh.hpp:146</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_a943bef15606fe840781ac73b738bab8f"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#a943bef15606fe840781ac73b738bab8f">alps::gf::legendre_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar, const std::string &amp;path) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00960">mesh.hpp:960</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_aa6b6db05b56f164c0a4c069c15d1c3e1"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#aa6b6db05b56f164c0a4c069c15d1c3e1">alps::gf::index_mesh::points</a></div><div class="ttdeci">const std::vector&lt; int &gt; &amp; points() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00833">mesh.hpp:833</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1generic__index_html_a064b8ff1064ae1bacf81fad1e9bf9344"><div class="ttname"><a href="classalps_1_1gf_1_1generic__index.html#a064b8ff1064ae1bacf81fad1e9bf9344">alps::gf::generic_index::operator+=</a></div><div class="ttdeci">generic_index &amp; operator+=(int i)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00055">mesh.hpp:55</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_1_1statistics_html_a29765aa587b6e2ed7fa9b237762ef992a5186b8900b5e2ef2a9316840d7463c6f"><div class="ttname"><a href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992a5186b8900b5e2ef2a9316840d7463c6f">alps::gf::statistics::BOSONIC</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00032">mesh.hpp:32</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_acbea80c76ab6e22306ccce10eb4e5a91"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#acbea80c76ab6e22306ccce10eb4e5a91">alps::gf::matsubara_mesh::check_range</a></div><div class="ttdeci">void check_range()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00323">mesh.hpp:323</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_a7a2bbcf7afb8669e6c0e3641464832cd"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#a7a2bbcf7afb8669e6c0e3641464832cd">alps::gf::itime_mesh::index_type</a></div><div class="ttdeci">generic_index&lt; itime_mesh &gt; index_type</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00369">mesh.hpp:369</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_aed03bcfb332f7f2e10c3ee76b264bca6"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#aed03bcfb332f7f2e10c3ee76b264bca6">alps::gf::itime_mesh::itime_mesh</a></div><div class="ttdeci">itime_mesh()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00371">mesh.hpp:371</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_ace8c82e4ab9e996445dd6b70af3cdd51"><div class="ttname"><a href="namespacealps_1_1gf.html#ace8c82e4ab9e996445dd6b70af3cdd51">alps::gf::index</a></div><div class="ttdeci">index_mesh::index_type index</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01247">mesh.hpp:1247</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a88f81b1c3187e57197326aeafde8bb8c"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a88f81b1c3187e57197326aeafde8bb8c">alps::gf::numerical_mesh::operator==</a></div><div class="ttdeci">bool operator==(const numerical_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01104">mesh.hpp:1104</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_a1a7b71193e7a8d4d98d7bad382a4aa14"><div class="ttname"><a href="namespacealps_1_1gf.html#a1a7b71193e7a8d4d98d7bad382a4aa14">alps::gf::swap</a></div><div class="ttdeci">void swap(matsubara_mesh&lt; PTYPE &gt; &amp;a, matsubara_mesh&lt; PTYPE &gt; &amp;b)</div><div class="ttdoc">Swaps two Matsubara meshes. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00350">mesh.hpp:350</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__index__mesh_html_aca9ec5d443064b7b159f4b76dabf1d57"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__index__mesh.html#aca9ec5d443064b7b159f4b76dabf1d57">alps::gf::momentum_index_mesh::momentum_index_mesh</a></div><div class="ttdeci">momentum_index_mesh(int ns, int ndim)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00785">mesh.hpp:785</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_a675bafdead97dbac5d9e0779f0a9d423"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#a675bafdead97dbac5d9e0779f0a9d423">alps::gf::itime_mesh::extent</a></div><div class="ttdeci">int extent() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00391">mesh.hpp:391</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_aac36ab8f8f8e6b9ba99658d1c5d7a1e7"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#aac36ab8f8f8e6b9ba99658d1c5d7a1e7">alps::gf::power_mesh::weights</a></div><div class="ttdeci">const std::vector&lt; double &gt; &amp; weights() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00546">mesh.hpp:546</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html_a1029f813d107be9f18a8cb5d6a42a5f2"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html#a1029f813d107be9f18a8cb5d6a42a5f2">alps::gf::real_frequency_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar) const </div><div class="ttdoc">Save to HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00134">mesh.hpp:134</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_af1f3b5992d1f43105dc01829f696a20c"><div class="ttname"><a href="namespacealps_1_1gf.html#af1f3b5992d1f43105dc01829f696a20c">alps::gf::numerical_mesh_index</a></div><div class="ttdeci">numerical_mesh&lt; double &gt;::index_type numerical_mesh_index</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01250">mesh.hpp:1250</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_a58dbd96914103c6f2940a69e6db2c1d8"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#a58dbd96914103c6f2940a69e6db2c1d8">alps::gf::legendre_mesh::operator==</a></div><div class="ttdeci">bool operator==(const legendre_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00932">mesh.hpp:932</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1generic__index_html_a96ab537cce7d3654b03912227131c876"><div class="ttname"><a href="classalps_1_1gf_1_1generic__index.html#a96ab537cce7d3654b03912227131c876">alps::gf::generic_index::operator&lt;</a></div><div class="ttdeci">bool operator&lt;(int x) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00058">mesh.hpp:58</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_a358481821a7ad7f128dfad26bea6852a"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#a358481821a7ad7f128dfad26bea6852a">alps::gf::matsubara_mesh::positivity</a></div><div class="ttdeci">mesh::frequency_positivity_type positivity() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00230">mesh.hpp:230</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_a20f6d4710a4b21835a636eb0eaf1774c"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#a20f6d4710a4b21835a636eb0eaf1774c">alps::gf::matsubara_mesh::matsubara_mesh</a></div><div class="ttdeci">matsubara_mesh(const matsubara_mesh &amp;rhs)</div><div class="ttdoc">copy constructor </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00194">mesh.hpp:194</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html_ace14cfc8456b08cf0aa115cd23bc356c"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html#ace14cfc8456b08cf0aa115cd23bc356c">alps::gf::real_frequency_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar, const std::string &amp;path) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00118">mesh.hpp:118</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_ad52fae0ed407952749b5e78ed4489f77"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#ad52fae0ed407952749b5e78ed4489f77">alps::gf::legendre_mesh::operator()</a></div><div class="ttdeci">int operator()(index_type idx) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00924">mesh.hpp:924</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1generic__index_html_a08c2e12bf7dfb0b7383f5f64acd3bafd"><div class="ttname"><a href="classalps_1_1gf_1_1generic__index.html#a08c2e12bf7dfb0b7383f5f64acd3bafd">alps::gf::generic_index::operator--</a></div><div class="ttdeci">generic_index &amp; operator--()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00053">mesh.hpp:53</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_a230cf0e279596505db0cb5f78b2bf208"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#a230cf0e279596505db0cb5f78b2bf208">alps::gf::matsubara_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar) const </div><div class="ttdoc">Save to HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00280">mesh.hpp:280</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a6454b09d70641361693ea097c87a2c2c"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a6454b09d70641361693ea097c87a2c2c">alps::gf::momentum_realspace_index_mesh::momentum_realspace_index_mesh</a></div><div class="ttdeci">momentum_realspace_index_mesh(const momentum_realspace_index_mesh &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00662">mesh.hpp:662</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a1c52d76dd9ea0d6a506622d399b4df02"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a1c52d76dd9ea0d6a506622d399b4df02">alps::gf::numerical_mesh::basis_function</a></div><div class="ttdeci">const piecewise_polynomial&lt; T &gt; &amp; basis_function(int l) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01118">mesh.hpp:1118</a></div></div>
<div class="ttc" id="archive_8hpp_html"><div class="ttname"><a href="archive_8hpp.html">archive.hpp</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__index__mesh_html_a693c37fcea4a5b2ad49533c49e022388"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__index__mesh.html#a693c37fcea4a5b2ad49533c49e022388">alps::gf::momentum_index_mesh::momentum_index_mesh</a></div><div class="ttdeci">momentum_index_mesh()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00781">mesh.hpp:781</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_acac73dc8ebdb4c0faa4b3e789e5a8ab0"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#acac73dc8ebdb4c0faa4b3e789e5a8ab0">alps::gf::itime_mesh::statistics</a></div><div class="ttdeci">statistics::statistics_type statistics() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00402">mesh.hpp:402</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_a17d42b39f148e3ae14f4b691485b6cb0"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#a17d42b39f148e3ae14f4b691485b6cb0">alps::gf::itime_mesh::itime_mesh</a></div><div class="ttdeci">itime_mesh(const itime_mesh &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00375">mesh.hpp:375</a></div></div>
<div class="ttc" id="namespaceboost_html"><div class="ttname"><a href="namespaceboost.html">boost</a></div><div class="ttdef"><b>Definition:</b> <a href="binning__analysis_8cpp_source.html#l00021">binning_analysis.cpp:21</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1generic__index_html_adcfad35c459ef2dede788f72f22567c1"><div class="ttname"><a href="classalps_1_1gf_1_1generic__index.html#adcfad35c459ef2dede788f72f22567c1">alps::gf::generic_index::generic_index</a></div><div class="ttdeci">generic_index(int i)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00047">mesh.hpp:47</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html">alps::gf::matsubara_mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00175">mesh.hpp:175</a></div></div>
<div class="ttc" id="namespacealps_1_1hdf5_html_ad7d3b93546b617b7dd2c737f41778de0"><div class="ttname"><a href="namespacealps_1_1hdf5.html#ad7d3b93546b617b7dd2c737f41778de0">alps::hdf5::load</a></div><div class="ttdeci">void load(archive &amp;ar, std::string const &amp;path, T &amp;value, std::vector&lt; std::size_t &gt; chunk=std::vector&lt; std::size_t &gt;(), std::vector&lt; std::size_t &gt;=std::vector&lt; std::size_t &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="archive_8hpp_source.html#l00309">archive.hpp:309</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a3e7922e3dcb675cd4369574beefe0440"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a3e7922e3dcb675cd4369574beefe0440">alps::gf::numerical_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar, const std::string &amp;path) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01147">mesh.hpp:1147</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1base__mesh_html_ae9897cad2f596791e4eed2245d4adad3"><div class="ttname"><a href="classalps_1_1gf_1_1base__mesh.html#ae9897cad2f596791e4eed2245d4adad3">alps::gf::base_mesh::base_mesh</a></div><div class="ttdeci">base_mesh()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00079">mesh.hpp:79</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html_a6da32a1fb6b23f09a8567e4224cc9ce3"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html#a6da32a1fb6b23f09a8567e4224cc9ce3">alps::gf::real_frequency_mesh::index_type</a></div><div class="ttdeci">generic_index&lt; real_frequency_mesh &gt; index_type</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00102">mesh.hpp:102</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1generic__index_html_a587673ab9633d138c5c97848b262e3b5"><div class="ttname"><a href="classalps_1_1gf_1_1generic__index.html#a587673ab9633d138c5c97848b262e3b5">alps::gf::generic_index::operator=</a></div><div class="ttdeci">void operator=(int i)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00050">mesh.hpp:50</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a8459f2593f26d3d6cb1dd96589123b6d"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a8459f2593f26d3d6cb1dd96589123b6d">alps::gf::power_mesh::power</a></div><div class="ttdeci">int power() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00532">mesh.hpp:532</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_aee39d45390464e4236427063351bd6e4"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#aee39d45390464e4236427063351bd6e4">alps::gf::legendre_mesh::legendre_mesh</a></div><div class="ttdeci">legendre_mesh(const legendre_mesh &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00913">mesh.hpp:913</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1generic__index_html_a60ecc2ec965268ac4437d00ed6184373"><div class="ttname"><a href="classalps_1_1gf_1_1generic__index.html#a60ecc2ec965268ac4437d00ed6184373">alps::gf::generic_index::operator()</a></div><div class="ttdeci">int operator()() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00062">mesh.hpp:62</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_a0c072dc142db347cd3713f168f0789d8"><div class="ttname"><a href="namespacealps_1_1gf.html#a0c072dc142db347cd3713f168f0789d8">alps::gf::operator&lt;&lt;</a></div><div class="ttdeci">std::ostream &amp; operator&lt;&lt;(std::ostream &amp;os, const real_frequency_mesh &amp;M)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l00040">mesh.cpp:40</a></div></div>
<div class="ttc" id="namespacealps_html_ad18068978b72b94a2ba76995d8afc022"><div class="ttname"><a href="namespacealps.html#ad18068978b72b94a2ba76995d8afc022">alps::size</a></div><div class="ttdeci">std::enable_if&lt;!is_sequence&lt; T &gt;::value, std::size_t &gt;::type size(T const &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="size_8hpp_source.html#l00020">size.hpp:20</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_ab7247de583fbf809d9088fa940ebab3c"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#ab7247de583fbf809d9088fa940ebab3c">alps::gf::itime_mesh::operator()</a></div><div class="ttdeci">int operator()(index_type idx) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00385">mesh.hpp:385</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a711ace1ec578066a79622dd357612c63"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a711ace1ec578066a79622dd357612c63">alps::gf::momentum_realspace_index_mesh::dimension</a></div><div class="ttdeci">int dimension() const </div><div class="ttdoc">returns the spatial dimension </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00700">mesh.hpp:700</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_aae8541a155e29c5007e7e0d179bf4d85"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#aae8541a155e29c5007e7e0d179bf4d85">alps::gf::matsubara_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar, const std::string &amp;path)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00255">mesh.hpp:255</a></div></div>
<div class="ttc" id="namespacealps_html_af2c7efa5b1cc5ec2eb6b8e1f7362d48e"><div class="ttname"><a href="namespacealps.html#af2c7efa5b1cc5ec2eb6b8e1f7362d48e">alps::broadcast</a></div><div class="ttdeci">void broadcast(C const &amp;c, P &amp;p, int r=0)</div><div class="ttdef"><b>Definition:</b> <a href="api_8hpp_source.html#l00056">api.hpp:56</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__index__mesh_html_a7030e07070c46290cb127c5819bd92d3"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__index__mesh.html#a7030e07070c46290cb127c5819bd92d3">alps::gf::momentum_index_mesh::operator=</a></div><div class="ttdeci">momentum_index_mesh &amp; operator=(const momentum_index_mesh &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00776">mesh.hpp:776</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_ada9ec27f9328de7791d32188193c8279"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#ada9ec27f9328de7791d32188193c8279">alps::gf::itime_mesh::operator!=</a></div><div class="ttdeci">bool operator!=(const itime_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00406">mesh.hpp:406</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html">alps::gf::itime_mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00354">mesh.hpp:354</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a4d39cdc54566ddd209dc1a0a1d9f0b2d"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a4d39cdc54566ddd209dc1a0a1d9f0b2d">alps::gf::momentum_realspace_index_mesh::points</a></div><div class="ttdeci">container_type &amp; points()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00718">mesh.hpp:718</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_aa2de6a4ca4d0688cd18dd930bbced6c7"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#aa2de6a4ca4d0688cd18dd930bbced6c7">alps::gf::matsubara_mesh::operator()</a></div><div class="ttdeci">int operator()(index_type idx) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00208">mesh.hpp:208</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_aa25b38b83f363fd299253dd34f3bdf5f"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#aa25b38b83f363fd299253dd34f3bdf5f">alps::gf::matsubara_mesh::index_type</a></div><div class="ttdeci">generic_index&lt; matsubara_mesh &gt; index_type</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00192">mesh.hpp:192</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a353ff35d78c16768db6b8db81208a4de"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a353ff35d78c16768db6b8db81208a4de">alps::gf::power_mesh::statistics</a></div><div class="ttdeci">statistics::statistics_type statistics() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00544">mesh.hpp:544</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_ad6485679a3acb328cd4a591220d93427"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#ad6485679a3acb328cd4a591220d93427">alps::gf::legendre_mesh::swap</a></div><div class="ttdeci">void swap(legendre_mesh &amp;other)</div><div class="ttdoc">Swaps this and another mesh. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00949">mesh.hpp:949</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_ae6ed8c9c415c5f91a14f519444c23938"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#ae6ed8c9c415c5f91a14f519444c23938">alps::gf::numerical_mesh::operator!=</a></div><div class="ttdeci">bool operator!=(const numerical_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01110">mesh.hpp:1110</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_a6697d22fbddc3f026641cefd90c208b7"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#a6697d22fbddc3f026641cefd90c208b7">alps::gf::index_mesh::index_mesh</a></div><div class="ttdeci">index_mesh(const index_mesh &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00827">mesh.hpp:827</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a7fec4ae2fca9bd3a9d72b7a61037c9de"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a7fec4ae2fca9bd3a9d72b7a61037c9de">alps::gf::momentum_realspace_index_mesh::operator!=</a></div><div class="ttdeci">bool operator!=(const momentum_realspace_index_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00712">mesh.hpp:712</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a1ca1ac15df4f697a179bd71e385ad135"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a1ca1ac15df4f697a179bd71e385ad135">alps::gf::power_mesh::operator==</a></div><div class="ttdeci">bool operator==(const power_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00536">mesh.hpp:536</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__index__mesh_html_ab51d457ce5efddff41fd0927edeb5b75"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__index__mesh.html#ab51d457ce5efddff41fd0927edeb5b75">alps::gf::momentum_index_mesh::momentum_index_mesh</a></div><div class="ttdeci">momentum_index_mesh(const momentum_index_mesh &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00774">mesh.hpp:774</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a1fb434b15f95d0b3d8ad56ff99d26567"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a1fb434b15f95d0b3d8ad56ff99d26567">alps::gf::numerical_mesh::numerical_mesh</a></div><div class="ttdeci">numerical_mesh(double b, const std::vector&lt; piecewise_polynomial&lt; T &gt; &gt; &amp;basis_functions, gf::statistics::statistics_type statistics=statistics::FERMIONIC)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01085">mesh.hpp:1085</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html_a606cc617dc48fdc7e7f9ee12de741933"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html#a606cc617dc48fdc7e7f9ee12de741933">alps::gf::real_frequency_mesh::real_frequency_mesh</a></div><div class="ttdeci">real_frequency_mesh(const GRID &amp;grid)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00107">mesh.hpp:107</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_ad2dc4505fcc7ca7b8b6df3f99446b541"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#ad2dc4505fcc7ca7b8b6df3f99446b541">alps::gf::power_mesh::operator!=</a></div><div class="ttdeci">bool operator!=(const power_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00549">mesh.hpp:549</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html_a13f9fb50dfa35b474bfa8e65f373ebdd"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html#a13f9fb50dfa35b474bfa8e65f373ebdd">alps::gf::real_frequency_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar, const std::string &amp;path)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00125">mesh.hpp:125</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_afd59455c192ca5ca12231c10df731516"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#afd59455c192ca5ca12231c10df731516">alps::gf::momentum_realspace_index_mesh::momentum_realspace_index_mesh</a></div><div class="ttdeci">momentum_realspace_index_mesh()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00684">mesh.hpp:684</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_a51d806b61f907e329a6f9a41abb9077e"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#a51d806b61f907e329a6f9a41abb9077e">alps::gf::matsubara_mesh::operator!=</a></div><div class="ttdeci">bool operator!=(const matsubara_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00222">mesh.hpp:222</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a5836ac26fcab1323f255837d953bba47"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a5836ac26fcab1323f255837d953bba47">alps::gf::momentum_realspace_index_mesh::operator=</a></div><div class="ttdeci">momentum_realspace_index_mesh &amp; operator=(const momentum_realspace_index_mesh &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00666">mesh.hpp:666</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__index__mesh_html_a5be9dc5ff1357feb487421e2c9d4ff02"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__index__mesh.html#a5be9dc5ff1357feb487421e2c9d4ff02">alps::gf::momentum_index_mesh::operator()</a></div><div class="ttdeci">int operator()(index_type idx) const </div><div class="ttdoc">Returns the index of the mesh point in the data array. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00794">mesh.hpp:794</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_1_1mesh_html_a21307e152cbd7c19d4ef2285f1d3d33da62e5bad0c8e46cfbf0795fbd5cee952b"><div class="ttname"><a href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33da62e5bad0c8e46cfbf0795fbd5cee952b">alps::gf::mesh::POSITIVE_ONLY</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00073">mesh.hpp:73</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__space__index__mesh_html_a231ca3ffa1b3a5f09ae8fbcd049cc2a7"><div class="ttname"><a href="classalps_1_1gf_1_1real__space__index__mesh.html#a231ca3ffa1b3a5f09ae8fbcd049cc2a7">alps::gf::real_space_index_mesh::real_space_index_mesh</a></div><div class="ttdeci">real_space_index_mesh(const real_space_index_mesh &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00803">mesh.hpp:803</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_a2d00bd58ade2d412ca5ac2206d28fb89"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#a2d00bd58ade2d412ca5ac2206d28fb89">alps::gf::itime_mesh::points</a></div><div class="ttdeci">const std::vector&lt; double &gt; &amp; points() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00403">mesh.hpp:403</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_acacb860ecd3deac3713fac28a6018e69"><div class="ttname"><a href="namespacealps_1_1gf.html#acacb860ecd3deac3713fac28a6018e69">alps::gf::matsubara_positive_mesh</a></div><div class="ttdeci">matsubara_mesh&lt; mesh::POSITIVE_ONLY &gt; matsubara_positive_mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01240">mesh.hpp:1240</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a1431dee5f120a4e3d9117f168abc5996"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a1431dee5f120a4e3d9117f168abc5996">alps::gf::power_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar, const std::string &amp;path) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00554">mesh.hpp:554</a></div></div>
<div class="ttc" id="classalps_1_1mpi_1_1communicator_html"><div class="ttname"><a href="classalps_1_1mpi_1_1communicator.html">alps::mpi::communicator</a></div><div class="ttdoc">Encapsulation of an MPI communicator and some communicator-related operations. </div><div class="ttdef"><b>Definition:</b> <a href="utilities_2include_2alps_2utilities_2mpi_8hpp_source.html#l00111">mpi.hpp:111</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_ae19e4d5a7abb05805c4ba725a626798a"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#ae19e4d5a7abb05805c4ba725a626798a">alps::gf::legendre_mesh::index_type</a></div><div class="ttdeci">generic_index&lt; legendre_mesh &gt; index_type</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00912">mesh.hpp:912</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html_a88e29b2a3989d7a39c0acb1db87ae588"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html#a88e29b2a3989d7a39c0acb1db87ae588">alps::gf::real_frequency_mesh::extent</a></div><div class="ttdeci">int extent() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00110">mesh.hpp:110</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_ad200b2c8fe030847488b985742e7de87"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#ad200b2c8fe030847488b985742e7de87">alps::gf::matsubara_mesh::extent</a></div><div class="ttdeci">int extent() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00205">mesh.hpp:205</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_af8914c4cead3b52638515f4e7da935d4"><div class="ttname"><a href="namespacealps_1_1gf.html#af8914c4cead3b52638515f4e7da935d4">alps::gf::itime_index</a></div><div class="ttdeci">itime_mesh::index_type itime_index</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01244">mesh.hpp:1244</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a7ad7715b4f67e5da8e686ec33503609d"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a7ad7715b4f67e5da8e686ec33503609d">alps::gf::numerical_mesh::operator()</a></div><div class="ttdeci">int operator()(index_type idx) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01098">mesh.hpp:1098</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_abe7e57316de423a074ef3911f87cc733"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#abe7e57316de423a074ef3911f87cc733">alps::gf::numerical_mesh::operator=</a></div><div class="ttdeci">numerical_mesh &amp; operator=(const numerical_mesh &amp;other)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01139">mesh.hpp:1139</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_a60cad24496cfff82dcd92e7368ec1adb"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#a60cad24496cfff82dcd92e7368ec1adb">alps::gf::matsubara_mesh::swap</a></div><div class="ttdeci">void swap(matsubara_mesh &amp;other)</div><div class="ttdoc">Swaps this and another mesh. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00234">mesh.hpp:234</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a8f38034dfbaa0a55e30e2f0370d3338c"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a8f38034dfbaa0a55e30e2f0370d3338c">alps::gf::momentum_realspace_index_mesh::container_type</a></div><div class="ttdeci">boost::multi_array&lt; double, 2 &gt; container_type</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00661">mesh.hpp:661</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1base__mesh_html"><div class="ttname"><a href="classalps_1_1gf_1_1base__mesh.html">alps::gf::base_mesh</a></div><div class="ttdoc">Common part of interface and implementation for GF meshes. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00077">mesh.hpp:77</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_abb9d259df5acea876ca12acf13923158"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#abb9d259df5acea876ca12acf13923158">alps::gf::matsubara_mesh::operator==</a></div><div class="ttdeci">bool operator==(const matsubara_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00216">mesh.hpp:216</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html">alps::gf::index_mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00821">mesh.hpp:821</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_1_1statistics_html_a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0"><div class="ttname"><a href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992ab24e1d1a340114ad815ce7536214dae0">alps::gf::statistics::FERMIONIC</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00033">mesh.hpp:33</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1generic__index_html_a8bf01ca78562b9d4f73159291acdd499"><div class="ttname"><a href="classalps_1_1gf_1_1generic__index.html#a8bf01ca78562b9d4f73159291acdd499">alps::gf::generic_index::generic_index</a></div><div class="ttdeci">generic_index()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00048">mesh.hpp:48</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1generic__index_html_a0b0ffe664b28730cc00c1963ca092764"><div class="ttname"><a href="classalps_1_1gf_1_1generic__index.html#a0b0ffe664b28730cc00c1963ca092764">alps::gf::generic_index::operator++</a></div><div class="ttdeci">generic_index &amp; operator++()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00052">mesh.hpp:52</a></div></div>
<div class="ttc" id="classalps_1_1hdf5_1_1archive_html"><div class="ttname"><a href="classalps_1_1hdf5_1_1archive.html">alps::hdf5::archive</a></div><div class="ttdef"><b>Definition:</b> <a href="archive_8hpp_source.html#l00092">archive.hpp:92</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html_a78ec34a6662260d91a439d56c5242239"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html#a78ec34a6662260d91a439d56c5242239">alps::gf::real_frequency_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar)</div><div class="ttdoc">Load from HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00140">mesh.hpp:140</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_ab4432632e42d113ca315d99dc8e4d78d"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#ab4432632e42d113ca315d99dc8e4d78d">alps::gf::power_mesh::compute_weights</a></div><div class="ttdeci">void compute_weights()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00645">mesh.hpp:645</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a3af45d804a6f17397ad104196647f03f"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a3af45d804a6f17397ad104196647f03f">alps::gf::momentum_realspace_index_mesh::points</a></div><div class="ttdeci">const container_type &amp; points() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00717">mesh.hpp:717</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_a3a5a542165642735070a8023ccd8ec46"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#a3a5a542165642735070a8023ccd8ec46">alps::gf::itime_mesh::compute_points</a></div><div class="ttdeci">void compute_points()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00474">mesh.hpp:474</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html_a3a66807ade5895d91d1672dd0a93c361"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html#a3a66807ade5895d91d1672dd0a93c361">alps::gf::real_frequency_mesh::operator()</a></div><div class="ttdeci">int operator()(index_type idx) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00112">mesh.hpp:112</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_a3f288069e50035c683a014ac95a9b60f"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#a3f288069e50035c683a014ac95a9b60f">alps::gf::legendre_mesh::legendre_mesh</a></div><div class="ttdeci">legendre_mesh(gf::statistics::statistics_type statistics=statistics::FERMIONIC)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00914">mesh.hpp:914</a></div></div>
<div class="ttc" id="piecewise__polynomial_8hpp_html"><div class="ttname"><a href="piecewise__polynomial_8hpp.html">piecewise_polynomial.hpp</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_ae10d3c9eca3b192c06c4b3d382c0ee2f"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#ae10d3c9eca3b192c06c4b3d382c0ee2f">alps::gf::itime_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar) const </div><div class="ttdoc">Save to HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00446">mesh.hpp:446</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__space__index__mesh_html_add2208bf9bd0d07c079fb6ef59b24435"><div class="ttname"><a href="classalps_1_1gf_1_1real__space__index__mesh.html#add2208bf9bd0d07c079fb6ef59b24435">alps::gf::real_space_index_mesh::operator()</a></div><div class="ttdeci">int operator()(index_type idx) const </div><div class="ttdoc">Returns the index of the mesh point in the data array. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00818">mesh.hpp:818</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_ad035c882ae5b0716b03f30c2efdf8c25"><div class="ttname"><a href="namespacealps_1_1gf.html#ad035c882ae5b0716b03f30c2efdf8c25">alps::gf::matsubara_pn_mesh</a></div><div class="ttdeci">matsubara_mesh&lt; mesh::POSITIVE_NEGATIVE &gt; matsubara_pn_mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01241">mesh.hpp:1241</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a86d1895f27a312d724f36073b0247d3c"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a86d1895f27a312d724f36073b0247d3c">alps::gf::momentum_realspace_index_mesh::operator==</a></div><div class="ttdeci">bool operator==(const momentum_realspace_index_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00705">mesh.hpp:705</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_aee12b0ec70d91f1c9e8fdc158c03396f"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#aee12b0ec70d91f1c9e8fdc158c03396f">alps::gf::momentum_realspace_index_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar, const std::string &amp;path) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00720">mesh.hpp:720</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_a9d2585b0decef798b858117a80714df1"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#a9d2585b0decef798b858117a80714df1">alps::gf::itime_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar, const std::string &amp;path)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00423">mesh.hpp:423</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html">alps::gf::real_frequency_mesh</a></div><div class="ttdoc">Mesh of real frequencies. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00095">mesh.hpp:95</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_af6ac75f6ce527856a743403369df0c51"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#af6ac75f6ce527856a743403369df0c51">alps::gf::power_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar) const </div><div class="ttdoc">Save to HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00590">mesh.hpp:590</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a7de1706b3f11d373cc9d10af37dd5ed8"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a7de1706b3f11d373cc9d10af37dd5ed8">alps::gf::power_mesh::power_mesh</a></div><div class="ttdeci">power_mesh()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00518">mesh.hpp:518</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_a9890a39a66c49fa29d5e291cff809dc5"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#a9890a39a66c49fa29d5e291cff809dc5">alps::gf::index_mesh::operator==</a></div><div class="ttdeci">bool operator==(const index_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00842">mesh.hpp:842</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_a6d144afe8c73111c4a079164fafac7bc"><div class="ttname"><a href="namespacealps_1_1gf.html#a6d144afe8c73111c4a079164fafac7bc">alps::gf::real_space_index</a></div><div class="ttdeci">real_space_index_mesh::index_type real_space_index</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01246">mesh.hpp:1246</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_ad430566914bc1f521ab6a967d250345a"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#ad430566914bc1f521ab6a967d250345a">alps::gf::index_mesh::operator!=</a></div><div class="ttdeci">bool operator!=(const index_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00848">mesh.hpp:848</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__space__index__mesh_html_a18175d16169a26947a83cab72d2c809f"><div class="ttname"><a href="classalps_1_1gf_1_1real__space__index__mesh.html#a18175d16169a26947a83cab72d2c809f">alps::gf::real_space_index_mesh::real_space_index_mesh</a></div><div class="ttdeci">real_space_index_mesh(int ns, int ndim)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00809">mesh.hpp:809</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_a6f037beb9e347fcbc529eb41345e0e75"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#a6f037beb9e347fcbc529eb41345e0e75">alps::gf::matsubara_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar, const std::string &amp;path) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00244">mesh.hpp:244</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_a841f5cd66bcd3e6ebdf6ccb18efa39fd"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#a841f5cd66bcd3e6ebdf6ccb18efa39fd">alps::gf::matsubara_mesh::matsubara_mesh</a></div><div class="ttdeci">matsubara_mesh()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00195">mesh.hpp:195</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_a25704acb7d3f148752223ff3163cd768"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#a25704acb7d3f148752223ff3163cd768">alps::gf::index_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar, const std::string &amp;path) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00853">mesh.hpp:853</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_a51bf2f66013c93e75c2ffcf11fe8b226"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#a51bf2f66013c93e75c2ffcf11fe8b226">alps::gf::index_mesh::compute_points</a></div><div class="ttdeci">void compute_points()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00884">mesh.hpp:884</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_a73fa7b2db0dff03f6367cfee81af2f6f"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#a73fa7b2db0dff03f6367cfee81af2f6f">alps::gf::itime_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar)</div><div class="ttdoc">Load from HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00452">mesh.hpp:452</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a031f631f594cdd49eaec5a0f08de7127"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a031f631f594cdd49eaec5a0f08de7127">alps::gf::momentum_realspace_index_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar, const std::string &amp;path)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00727">mesh.hpp:727</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_1_1mesh_html_a21307e152cbd7c19d4ef2285f1d3d33da88b934123cf42710c685e88ac52b649c"><div class="ttname"><a href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33da88b934123cf42710c685e88ac52b649c">alps::gf::mesh::POSITIVE_NEGATIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00072">mesh.hpp:72</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_a9693cd11e9782fc02c242f23812f7306"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#a9693cd11e9782fc02c242f23812f7306">alps::gf::legendre_mesh::extent</a></div><div class="ttdeci">int extent() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00922">mesh.hpp:922</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_a06117374f9d05c34079cb36cdfbf92e9"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#a06117374f9d05c34079cb36cdfbf92e9">alps::gf::itime_mesh::itime_mesh</a></div><div class="ttdeci">itime_mesh(double beta, int ntau)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00381">mesh.hpp:381</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_afd30e02bfa48fceb2fae6f73f7c83169"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#afd30e02bfa48fceb2fae6f73f7c83169">alps::gf::momentum_realspace_index_mesh::points_</a></div><div class="ttdeci">container_type points_</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00673">mesh.hpp:673</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html_a8fb6812c5bf81d205576fdc2d4807b56"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html#a8fb6812c5bf81d205576fdc2d4807b56">alps::gf::real_frequency_mesh::operator!=</a></div><div class="ttdeci">bool operator!=(const real_frequency_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00152">mesh.hpp:152</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_a168126f993e995158aadfa7affbbf462"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#a168126f993e995158aadfa7affbbf462">alps::gf::legendre_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar) const </div><div class="ttdoc">Save to HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00989">mesh.hpp:989</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html">alps::gf::power_mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00494">mesh.hpp:494</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1generic__index_html_ae14f6cca58715cba7fdc4a5588930d30"><div class="ttname"><a href="classalps_1_1gf_1_1generic__index.html#ae14f6cca58715cba7fdc4a5588930d30">alps::gf::generic_index::operator==</a></div><div class="ttdeci">bool operator==(int x) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00060">mesh.hpp:60</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a4630115a2a8f0d28a20b16d5e5dda01c"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a4630115a2a8f0d28a20b16d5e5dda01c">alps::gf::numerical_mesh::statistics</a></div><div class="ttdeci">statistics::statistics_type statistics() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01117">mesh.hpp:1117</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_ab65b8d9d0a3c2c9352770e476ecc201e"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#ab65b8d9d0a3c2c9352770e476ecc201e">alps::gf::momentum_realspace_index_mesh::extent</a></div><div class="ttdeci">int extent() const </div><div class="ttdoc">Returns the number of points. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00698">mesh.hpp:698</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1base__mesh_html_a4a155d1871ab1b1d201a53785bc9a271"><div class="ttname"><a href="classalps_1_1gf_1_1base__mesh.html#a4a155d1871ab1b1d201a53785bc9a271">alps::gf::base_mesh::base_mesh</a></div><div class="ttdeci">base_mesh(const base_mesh &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00080">mesh.hpp:80</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a9454f9d96beeb85ba16a786c7cefeb5f"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a9454f9d96beeb85ba16a786c7cefeb5f">alps::gf::momentum_realspace_index_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar)</div><div class="ttdoc">Load from HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00742">mesh.hpp:742</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a949dd4f4424662320b8e7d1d1d13760d"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a949dd4f4424662320b8e7d1d1d13760d">alps::gf::numerical_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar)</div><div class="ttdoc">Load from HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01193">mesh.hpp:1193</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a89e8aae976aff5873b3c0290259c7dde"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a89e8aae976aff5873b3c0290259c7dde">alps::gf::momentum_realspace_index_mesh::momentum_realspace_index_mesh</a></div><div class="ttdeci">momentum_realspace_index_mesh(const std::string &amp;kind, int ns, int ndim)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00688">mesh.hpp:688</a></div></div>
<div class="ttc" id="classalps_1_1hdf5_1_1archive_html_a7aa40040a7beabb0d07fa3a757593190"><div class="ttname"><a href="classalps_1_1hdf5_1_1archive.html#a7aa40040a7beabb0d07fa3a757593190">alps::hdf5::archive::get_context</a></div><div class="ttdeci">std::string get_context() const </div><div class="ttdef"><b>Definition:</b> <a href="archive_8cpp_source.html#l00144">archive.cpp:144</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_a93be73af8f719e74b554bf277f76a08b"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#a93be73af8f719e74b554bf277f76a08b">alps::gf::index_mesh::extent</a></div><div class="ttdeci">int extent() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00831">mesh.hpp:831</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a9dae02578baeabbd23589eb689358260"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a9dae02578baeabbd23589eb689358260">alps::gf::numerical_mesh::numerical_mesh</a></div><div class="ttdeci">numerical_mesh(const numerical_mesh&lt; T &gt; &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01078">mesh.hpp:1078</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_a964232d56fa57f437e212795615e7543"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#a964232d56fa57f437e212795615e7543">alps::gf::legendre_mesh::statistics</a></div><div class="ttdeci">statistics::statistics_type statistics() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00945">mesh.hpp:945</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_a83e4dd3b179e3e0f771df3a63589242d"><div class="ttname"><a href="namespacealps_1_1gf.html#a83e4dd3b179e3e0f771df3a63589242d">alps::gf::matsubara_index</a></div><div class="ttdeci">matsubara_mesh&lt; mesh::POSITIVE_ONLY &gt;::index_type matsubara_index</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01242">mesh.hpp:1242</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a9ffeca4c79882350585c63db5ea0b311"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a9ffeca4c79882350585c63db5ea0b311">alps::gf::numerical_mesh::numerical_mesh</a></div><div class="ttdeci">numerical_mesh(gf::statistics::statistics_type statistics=statistics::FERMIONIC)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01082">mesh.hpp:1082</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a604856b11948e7b477bf0b02cebd037b"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a604856b11948e7b477bf0b02cebd037b">alps::gf::numerical_mesh::index_type</a></div><div class="ttdeci">generic_index&lt; numerical_mesh &gt; index_type</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01077">mesh.hpp:1077</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_aae7b9ad0a60c0128ecb1415dc82ebcf7"><div class="ttname"><a href="namespacealps_1_1gf.html#aae7b9ad0a60c0128ecb1415dc82ebcf7">alps::gf::legendre_index</a></div><div class="ttdeci">legendre_mesh::index_type legendre_index</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01249">mesh.hpp:1249</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a674aa7e99a519599981b575e380f9e1a"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a674aa7e99a519599981b575e380f9e1a">alps::gf::power_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar)</div><div class="ttdoc">Load from HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00596">mesh.hpp:596</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html_a447a9aec86a00db7b1e69cfb8f33d1a3"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html#a447a9aec86a00db7b1e69cfb8f33d1a3">alps::gf::real_frequency_mesh::real_frequency_mesh</a></div><div class="ttdeci">real_frequency_mesh(const real_frequency_mesh &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00104">mesh.hpp:104</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_a4d6ee24eba6f11e91ea18058ab89cd35"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#a4d6ee24eba6f11e91ea18058ab89cd35">alps::gf::index_mesh::operator()</a></div><div class="ttdeci">int operator()(index_type idx) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00832">mesh.hpp:832</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_a327357187cd7130d002dc7ea436b5025"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#a327357187cd7130d002dc7ea436b5025">alps::gf::itime_mesh::beta</a></div><div class="ttdeci">double beta() const </div><div class="ttdoc">Getter variables for members. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00401">mesh.hpp:401</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_a27179aa34156cadedd38a0d589093464"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#a27179aa34156cadedd38a0d589093464">alps::gf::legendre_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar, const std::string &amp;path)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00969">mesh.hpp:969</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a0235cc9d8115bc78519d9a4156fddda2"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a0235cc9d8115bc78519d9a4156fddda2">alps::gf::power_mesh::points</a></div><div class="ttdeci">const std::vector&lt; double &gt; &amp; points() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00545">mesh.hpp:545</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1base__mesh_html_aa568cbdc80f04312e070eaa12187691a"><div class="ttname"><a href="classalps_1_1gf_1_1base__mesh.html#aa568cbdc80f04312e070eaa12187691a">alps::gf::base_mesh::swap</a></div><div class="ttdeci">void swap(base_mesh &amp;other)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00086">mesh.hpp:86</a></div></div>
<div class="ttc" id="mpi__bcast_8hpp_html"><div class="ttname"><a href="mpi__bcast_8hpp.html">mpi_bcast.hpp</a></div><div class="ttdoc">Functions to MPI-broadcast internal data structures. </div></div>
<div class="ttc" id="classalps_1_1gf_1_1base__mesh_html_aca05e67b85d0c631f568d746da26f056"><div class="ttname"><a href="classalps_1_1gf_1_1base__mesh.html#aca05e67b85d0c631f568d746da26f056">alps::gf::base_mesh::_points</a></div><div class="ttdeci">std::vector&lt; double &gt; &amp; _points()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00085">mesh.hpp:85</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_a9ddf0990dc84fc1d73a3ba4a4a71c7d9"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#a9ddf0990dc84fc1d73a3ba4a4a71c7d9">alps::gf::legendre_mesh::legendre_mesh</a></div><div class="ttdeci">legendre_mesh(double b, int n_max, gf::statistics::statistics_type statistics=statistics::FERMIONIC)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00917">mesh.hpp:917</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_afd06518d4690757791cb75aa4a8294a8"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#afd06518d4690757791cb75aa4a8294a8">alps::gf::numerical_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar) const </div><div class="ttdoc">Save to HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01187">mesh.hpp:1187</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html">alps::gf::legendre_mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00899">mesh.hpp:899</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__space__index__mesh_html"><div class="ttname"><a href="classalps_1_1gf_1_1real__space__index__mesh.html">alps::gf::real_space_index_mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00797">mesh.hpp:797</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_aea88bb36fe9167edcf1c7aaee359581a"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#aea88bb36fe9167edcf1c7aaee359581a">alps::gf::index_mesh::index_mesh</a></div><div class="ttdeci">index_mesh()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00829">mesh.hpp:829</a></div></div>
<div class="ttc" id="multi__array_8hpp_html"><div class="ttname"><a href="multi__array_8hpp.html">multi_array.hpp</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a2c73ff2417badc37aefcb70f56b1f13a"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a2c73ff2417badc37aefcb70f56b1f13a">alps::gf::power_mesh::compute_points</a></div><div class="ttdeci">void compute_points()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00619">mesh.hpp:619</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a4ff1b1ac50f690ba0b8186f9b0df09a5"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a4ff1b1ac50f690ba0b8186f9b0df09a5">alps::gf::momentum_realspace_index_mesh::momentum_realspace_index_mesh</a></div><div class="ttdeci">momentum_realspace_index_mesh(const std::string &amp;kind, const container_type &amp;mesh_points)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00692">mesh.hpp:692</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a78bf46a840749911b49fb70cbc343c48"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a78bf46a840749911b49fb70cbc343c48">alps::gf::numerical_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar, const std::string &amp;path)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01159">mesh.hpp:1159</a></div></div>
<div class="ttc" id="vector_8hpp_html"><div class="ttname"><a href="vector_8hpp.html">vector.hpp</a></div></div>
<div class="ttc" id="namespacealps_1_1numeric_html_af3b1d25e7f72c9af81930fc04ed8759b"><div class="ttname"><a href="namespacealps_1_1numeric.html#af3b1d25e7f72c9af81930fc04ed8759b">alps::numeric::pow</a></div><div class="ttdeci">std::vector&lt; T &gt; pow(std::vector&lt; T &gt; vec, U index)</div><div class="ttdef"><b>Definition:</b> <a href="vector__functions_8hpp_source.html#l00213">vector_functions.hpp:213</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a909eca5d741a73be9709098cb0e040e6"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a909eca5d741a73be9709098cb0e040e6">alps::gf::power_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar, const std::string &amp;path)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00566">mesh.hpp:566</a></div></div>
<div class="ttc" id="classalps_1_1mpi_1_1communicator_html_a10df61f8be46705102c21e67f9e19c5b"><div class="ttname"><a href="classalps_1_1mpi_1_1communicator.html#a10df61f8be46705102c21e67f9e19c5b">alps::mpi::communicator::rank</a></div><div class="ttdeci">int rank() const </div><div class="ttdoc">Returns process rank in this communicator. </div><div class="ttdef"><b>Definition:</b> <a href="utilities_2include_2alps_2utilities_2mpi_8hpp_source.html#l00156">mpi.hpp:156</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_a3f2276269a2c84b1e6ea14440b1bac94"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#a3f2276269a2c84b1e6ea14440b1bac94">alps::gf::legendre_mesh::compute_points</a></div><div class="ttdeci">void compute_points()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01030">mesh.hpp:1030</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__index__mesh_html_ae403b7fc5f288c1fbdeb2a03be84f0fb"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__index__mesh.html#ae403b7fc5f288c1fbdeb2a03be84f0fb">alps::gf::momentum_index_mesh::momentum_index_mesh</a></div><div class="ttdeci">momentum_index_mesh(const container_type &amp;mesh_points)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00789">mesh.hpp:789</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_a143d61f265b1402146ea5ae7591972ed"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#a143d61f265b1402146ea5ae7591972ed">alps::gf::index_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar) const </div><div class="ttdoc">Save to HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00873">mesh.hpp:873</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a34b9e727a10c580cb14e9755662110d0"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a34b9e727a10c580cb14e9755662110d0">alps::gf::power_mesh::beta</a></div><div class="ttdeci">double beta() const </div><div class="ttdoc">Getter variables for members. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00543">mesh.hpp:543</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_a9fc4a570305c7158c84de5bb95ac779e"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#a9fc4a570305c7158c84de5bb95ac779e">alps::gf::index_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar, const std::string &amp;path)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00860">mesh.hpp:860</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_a40bf6de706b8e7d66126f767bab9ff6b"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#a40bf6de706b8e7d66126f767bab9ff6b">alps::gf::itime_mesh::operator==</a></div><div class="ttdeci">bool operator==(const itime_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00394">mesh.hpp:394</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_ab82540ace227b2944f44f29c1952aacf"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#ab82540ace227b2944f44f29c1952aacf">alps::gf::legendre_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar)</div><div class="ttdoc">Load from HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00995">mesh.hpp:995</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_a33845e38598a9f359196b3c5d8a84bd8"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#a33845e38598a9f359196b3c5d8a84bd8">alps::gf::matsubara_mesh::statistics</a></div><div class="ttdeci">statistics::statistics_type statistics() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00229">mesh.hpp:229</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__index__mesh_html"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__index__mesh.html">alps::gf::momentum_index_mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00768">mesh.hpp:768</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_a41aceaf617500748df0c0e144bd72d5e"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#a41aceaf617500748df0c0e144bd72d5e">alps::gf::legendre_mesh::check_range</a></div><div class="ttdeci">void check_range()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01027">mesh.hpp:1027</a></div></div>
<div class="ttc" id="namespacealps_1_1mpi_html_a4b3ef8026e4d4dd8ce8c0c6f05c1347f"><div class="ttname"><a href="namespacealps_1_1mpi.html#a4b3ef8026e4d4dd8ce8c0c6f05c1347f">alps::mpi::broadcast</a></div><div class="ttdeci">void broadcast(const communicator &amp;comm, T *vals, std::size_t count, int root)</div><div class="ttdoc">Broadcasts array vals of a primitive type T, length count on communicator comm with root root ...</div><div class="ttdef"><b>Definition:</b> <a href="utilities_2include_2alps_2utilities_2mpi_8hpp_source.html#l00270">mpi.hpp:270</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a52a16b94d7cee249bd6cd2fe04c3c1fb"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a52a16b94d7cee249bd6cd2fe04c3c1fb">alps::gf::power_mesh::power_mesh</a></div><div class="ttdeci">power_mesh(const power_mesh &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00513">mesh.hpp:513</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__space__index__mesh_html_a2acc86677bcd5c694e3bf1928a175e7b"><div class="ttname"><a href="classalps_1_1gf_1_1real__space__index__mesh.html#a2acc86677bcd5c694e3bf1928a175e7b">alps::gf::real_space_index_mesh::index_type</a></div><div class="ttdeci">generic_index&lt; momentum_index_mesh &gt; index_type</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00802">mesh.hpp:802</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_aa18971273af47106a562fcde97f6a712"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#aa18971273af47106a562fcde97f6a712">alps::gf::index_mesh::index_mesh</a></div><div class="ttdeci">index_mesh(int np)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00830">mesh.hpp:830</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a6a2e5f8f2b1d7a06add055517f001ebe"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a6a2e5f8f2b1d7a06add055517f001ebe">alps::gf::numerical_mesh::swap</a></div><div class="ttdeci">void swap(numerical_mesh &amp;other)</div><div class="ttdoc">Swaps this and another mesh. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01127">mesh.hpp:1127</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_1_1mesh_html_a21307e152cbd7c19d4ef2285f1d3d33d"><div class="ttname"><a href="namespacealps_1_1gf_1_1mesh.html#a21307e152cbd7c19d4ef2285f1d3d33d">alps::gf::mesh::frequency_positivity_type</a></div><div class="ttdeci">frequency_positivity_type</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00071">mesh.hpp:71</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_a2c92171efb17f1e6ad4fe4faa7956964"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#a2c92171efb17f1e6ad4fe4faa7956964">alps::gf::momentum_realspace_index_mesh::kind</a></div><div class="ttdeci">const std::string &amp; kind() const </div><div class="ttdoc">returns the mesh kind </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00702">mesh.hpp:702</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_a38a1aa679ad6e5bd55a8031030632743"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#a38a1aa679ad6e5bd55a8031030632743">alps::gf::legendre_mesh::operator!=</a></div><div class="ttdeci">bool operator!=(const legendre_mesh &amp;mesh) const </div><div class="ttdoc">Comparison operators. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00938">mesh.hpp:938</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__frequency__mesh_html_a6acaba26df449fc59c52a744ceb6ef8e"><div class="ttname"><a href="classalps_1_1gf_1_1real__frequency__mesh.html#a6acaba26df449fc59c52a744ceb6ef8e">alps::gf::real_frequency_mesh::real_frequency_mesh</a></div><div class="ttdeci">real_frequency_mesh()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00103">mesh.hpp:103</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1legendre__mesh_html_aef781f2408715fe6aeb566231a76ce70"><div class="ttname"><a href="classalps_1_1gf_1_1legendre__mesh.html#aef781f2408715fe6aeb566231a76ce70">alps::gf::legendre_mesh::beta</a></div><div class="ttdeci">double beta() const </div><div class="ttdoc">getter functions for member variables </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00944">mesh.hpp:944</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html">alps::gf::numerical_mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01046">mesh.hpp:1046</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_a659ce1a93ca0dd2463ab15df3771cd91"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#a659ce1a93ca0dd2463ab15df3771cd91">alps::gf::matsubara_mesh::matsubara_mesh</a></div><div class="ttdeci">matsubara_mesh(double b, int nfr, gf::statistics::statistics_type statistics=statistics::FERMIONIC)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00200">mesh.hpp:200</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_aae4b27521800097a89a553259921cd43"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#aae4b27521800097a89a553259921cd43">alps::gf::power_mesh::power_mesh</a></div><div class="ttdeci">power_mesh(double beta, int power, int uniform)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00521">mesh.hpp:521</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_a5f2d101d5fceef5582d582cf32d67a2d"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#a5f2d101d5fceef5582d582cf32d67a2d">alps::gf::index_mesh::operator=</a></div><div class="ttdeci">index_mesh &amp; operator=(const index_mesh &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00828">mesh.hpp:828</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_a6179662d3e53f2556de27d6056c556ab"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#a6179662d3e53f2556de27d6056c556ab">alps::gf::matsubara_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar)</div><div class="ttdoc">Load from HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00286">mesh.hpp:286</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_1_1statistics_html_a29765aa587b6e2ed7fa9b237762ef992"><div class="ttname"><a href="namespacealps_1_1gf_1_1statistics.html#a29765aa587b6e2ed7fa9b237762ef992">alps::gf::statistics::statistics_type</a></div><div class="ttdeci">statistics_type</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00031">mesh.hpp:31</a></div></div>
<div class="ttc" id="flagcheck_8hpp_html"><div class="ttname"><a href="flagcheck_8hpp.html">flagcheck.hpp</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__space__index__mesh_html_a5561f18c93b9b1666fcaa7502cc1d4c5"><div class="ttname"><a href="classalps_1_1gf_1_1real__space__index__mesh.html#a5561f18c93b9b1666fcaa7502cc1d4c5">alps::gf::real_space_index_mesh::real_space_index_mesh</a></div><div class="ttdeci">real_space_index_mesh()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00805">mesh.hpp:805</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_aa381fd285534908e04fbcfe63c679b6d"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#aa381fd285534908e04fbcfe63c679b6d">alps::gf::index_mesh::throw_if_empty</a></div><div class="ttdeci">void throw_if_empty() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00835">mesh.hpp:835</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html">alps::gf::momentum_realspace_index_mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00659">mesh.hpp:659</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__realspace__index__mesh_html_ab1980f722e42ff263fb8727930de0694"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__realspace__index__mesh.html#ab1980f722e42ff263fb8727930de0694">alps::gf::momentum_realspace_index_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar) const </div><div class="ttdoc">Save to HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00736">mesh.hpp:736</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a3dfc7e7c7fd73db4534833c90db3258c"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a3dfc7e7c7fd73db4534833c90db3258c">alps::gf::power_mesh::operator()</a></div><div class="ttdeci">int operator()(index_type idx) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00525">mesh.hpp:525</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a69bca9e50ff230a1505aa26974bfece7"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a69bca9e50ff230a1505aa26974bfece7">alps::gf::numerical_mesh::extent</a></div><div class="ttdeci">int extent() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01093">mesh.hpp:1093</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_a39922e64f2469331acd41907559e06f9"><div class="ttname"><a href="namespacealps_1_1gf.html#a39922e64f2469331acd41907559e06f9">alps::gf::matsubara_pn_index</a></div><div class="ttdeci">matsubara_mesh&lt; mesh::POSITIVE_NEGATIVE &gt;::index_type matsubara_pn_index</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01243">mesh.hpp:1243</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_ab27723e073b4b42cf2b4b54980bbce3d"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#ab27723e073b4b42cf2b4b54980bbce3d">alps::gf::power_mesh::index_type</a></div><div class="ttdeci">generic_index&lt; power_mesh &gt; index_type</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00511">mesh.hpp:511</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_aa8c7ea4ee38b6ebff477fae0c6aec8f7"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#aa8c7ea4ee38b6ebff477fae0c6aec8f7">alps::gf::matsubara_mesh::beta</a></div><div class="ttdeci">double beta() const </div><div class="ttdoc">getter functions for member variables </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00228">mesh.hpp:228</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1index__mesh_html_a36c55dc6b034ba7a7d0ac22b31af9cbb"><div class="ttname"><a href="classalps_1_1gf_1_1index__mesh.html#a36c55dc6b034ba7a7d0ac22b31af9cbb">alps::gf::index_mesh::load</a></div><div class="ttdeci">void load(alps::hdf5::archive &amp;ar)</div><div class="ttdoc">Load from HDF5. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00879">mesh.hpp:879</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1power__mesh_html_a4c4ac18efa01f5534fa326f69a2dc8f3"><div class="ttname"><a href="classalps_1_1gf_1_1power__mesh.html#a4c4ac18efa01f5534fa326f69a2dc8f3">alps::gf::power_mesh::extent</a></div><div class="ttdeci">int extent() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00531">mesh.hpp:531</a></div></div>
<div class="ttc" id="namespacealps_html"><div class="ttname"><a href="namespacealps.html">alps</a></div><div class="ttdef"><b>Definition:</b> <a href="boost__array__functions_8hpp_source.html#l00024">boost_array_functions.hpp:24</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1real__space__index__mesh_html_afd3261478c8ac0fffdd970d0595479b6"><div class="ttname"><a href="classalps_1_1gf_1_1real__space__index__mesh.html#afd3261478c8ac0fffdd970d0595479b6">alps::gf::real_space_index_mesh::real_space_index_mesh</a></div><div class="ttdeci">real_space_index_mesh(const container_type &amp;mesh_points)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00813">mesh.hpp:813</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a27c570aec1421c84e91a64d320c15634"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a27c570aec1421c84e91a64d320c15634">alps::gf::numerical_mesh::compute_points</a></div><div class="ttdeci">void compute_points()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01232">mesh.hpp:1232</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1numerical__mesh_html_a713e9fa9f5bb45046532c6a7f511f29e"><div class="ttname"><a href="classalps_1_1gf_1_1numerical__mesh.html#a713e9fa9f5bb45046532c6a7f511f29e">alps::gf::numerical_mesh::beta</a></div><div class="ttdeci">double beta() const </div><div class="ttdoc">getter functions for member variables </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01116">mesh.hpp:1116</a></div></div>
<div class="ttc" id="complex_8hpp_html"><div class="ttname"><a href="complex_8hpp.html">complex.hpp</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_a0d95056f15a31f09074e923af11ea31e"><div class="ttname"><a href="namespacealps_1_1gf.html#a0d95056f15a31f09074e923af11ea31e">alps::gf::momentum_index</a></div><div class="ttdeci">momentum_index_mesh::index_type momentum_index</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01245">mesh.hpp:1245</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1momentum__index__mesh_html_aea623ee14b2afa45dc3f7cc3c609e1ca"><div class="ttname"><a href="classalps_1_1gf_1_1momentum__index__mesh.html#aea623ee14b2afa45dc3f7cc3c609e1ca">alps::gf::momentum_index_mesh::index_type</a></div><div class="ttdeci">generic_index&lt; momentum_index_mesh &gt; index_type</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00773">mesh.hpp:773</a></div></div>
<div class="ttc" id="namespacealps_1_1gf_html_a71cceb67c6804dae9c372b333e5af3cc"><div class="ttname"><a href="namespacealps_1_1gf.html#a71cceb67c6804dae9c372b333e5af3cc">alps::gf::real_freq_index</a></div><div class="ttdeci">real_frequency_mesh::index_type real_freq_index</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01248">mesh.hpp:1248</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1base__mesh_html_a9be1891f8c0bc567695fad180712313a"><div class="ttname"><a href="classalps_1_1gf_1_1base__mesh.html#a9be1891f8c0bc567695fad180712313a">alps::gf::base_mesh::points</a></div><div class="ttdeci">const std::vector&lt; double &gt; &amp; points() const </div><div class="ttdoc">Const access to mesh points. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00082">mesh.hpp:82</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1generic__index_html_a6986dd5e127aea75e5474982de205488"><div class="ttname"><a href="classalps_1_1gf_1_1generic__index.html#a6986dd5e127aea75e5474982de205488">alps::gf::generic_index::operator-=</a></div><div class="ttdeci">generic_index &amp; operator-=(int i)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00056">mesh.hpp:56</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1piecewise__polynomial_html"><div class="ttname"><a href="classalps_1_1gf_1_1piecewise__polynomial.html">alps::gf::piecewise_polynomial</a></div><div class="ttdoc">Class representing a piecewise polynomial and utilities. </div><div class="ttdef"><b>Definition:</b> <a href="piecewise__polynomial_8hpp_source.html#l00032">piecewise_polynomial.hpp:32</a></div></div>
<div class="ttc" id="namespacealps_1_1hdf5_html_af7bd6d9b36671271f03c94f7cd0bd324"><div class="ttname"><a href="namespacealps_1_1hdf5.html#af7bd6d9b36671271f03c94f7cd0bd324">alps::hdf5::save</a></div><div class="ttdeci">void save(archive &amp;ar, std::string const &amp;path, T const &amp;value, std::vector&lt; std::size_t &gt;=std::vector&lt; std::size_t &gt;(), std::vector&lt; std::size_t &gt; chunk=std::vector&lt; std::size_t &gt;(), std::vector&lt; std::size_t &gt;=std::vector&lt; std::size_t &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="archive_8hpp_source.html#l00292">archive.hpp:292</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1generic__index_html"><div class="ttname"><a href="classalps_1_1gf_1_1generic__index.html">alps::gf::generic_index</a></div><div class="ttdoc">A generic index. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00039">mesh.hpp:39</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1matsubara__mesh_html_a1c37e929a3af6f964cd93d82f7937056"><div class="ttname"><a href="classalps_1_1gf_1_1matsubara__mesh.html#a1c37e929a3af6f964cd93d82f7937056">alps::gf::matsubara_mesh::compute_points</a></div><div class="ttdeci">void compute_points()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00331">mesh.hpp:331</a></div></div>
<div class="ttc" id="classalps_1_1gf_1_1itime__mesh_html_a598fcf55a2a8aaaaf000f2f8ae603c6d"><div class="ttname"><a href="classalps_1_1gf_1_1itime__mesh.html#a598fcf55a2a8aaaaf000f2f8ae603c6d">alps::gf::itime_mesh::save</a></div><div class="ttdeci">void save(alps::hdf5::archive &amp;ar, const std::string &amp;path) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00411">mesh.hpp:411</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Oct 14 2018 12:18:30 for ALPSCore reference by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
